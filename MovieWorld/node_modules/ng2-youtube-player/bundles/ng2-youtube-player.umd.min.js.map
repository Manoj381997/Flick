{"version":3,"file":"ng2-youtube-player.umd.min.js","sources":["../../src/services/youtube-player.service.ts","../../src/modules/youtube-player.component.ts","../../src/modules/ng2-youtube-player.module.ts"],"sourcesContent":["import { Http, URLSearchParams, Response } from '@angular/http';\nimport { Injectable, NgZone, EventEmitter } from '@angular/core';\nimport { ReplaySubject } from 'rxjs/ReplaySubject';\nimport { IPlayerApiScriptOptions, IPlayerOutputs, IPlayerSize } from '../models';\nexport class YoutubePlayerService {\n/**\n * @return {?}\n */\nstatic get win () {\n    return window;\n  }\n/**\n * @return {?}\n */\nstatic get YT() {\n    return YoutubePlayerService.win['YT'];\n  }\n/**\n * @return {?}\n */\nstatic get Player() {\n    return YoutubePlayerService.YT.Player;\n  }\n\n  api: ReplaySubject<YT.Player>;\nprivate isFullscreen: boolean = false;\nprivate defaultSizes = {\n      height: 270,\n      width: 367\n  };\n/**\n * @param {?} zone\n */\nconstructor (private zone: NgZone) {\n    this.createApi();\n  }\n/**\n * @param {?} options\n * @return {?}\n */\nloadPlayerApi (options: IPlayerApiScriptOptions) {\n    const /** @type {?} */ doc = YoutubePlayerService.win.document;\n    let /** @type {?} */ playerApiScript = doc.createElement(\"script\");\n    playerApiScript.type = \"text/javascript\";\n    playerApiScript.src = `${options.protocol}://www.youtube.com/iframe_api`;\n    doc.body.appendChild(playerApiScript);\n  }\n/**\n * @param {?} elementId\n * @param {?} outputs\n * @param {?} sizes\n * @param {?=} videoId\n * @param {?=} playerVars\n * @return {?}\n */\nsetupPlayer (\n    elementId: string, outputs: IPlayerOutputs, sizes: IPlayerSize,\n    videoId = '', playerVars: YT.PlayerVars) {\n    const /** @type {?} */ createPlayer = () => {\n      if (YoutubePlayerService.Player) {\n        this.createPlayer(elementId, outputs, sizes, videoId, playerVars);\n      }\n    };\n    this.api.subscribe(createPlayer);\n  }\n/**\n * @param {?} player\n * @return {?}\n */\nplay (player: YT.Player) {\n    player.playVideo();\n  }\n/**\n * @param {?} player\n * @return {?}\n */\npause (player: YT.Player) {\n    player.pauseVideo();\n  }\n/**\n * @param {?} media\n * @param {?} player\n * @return {?}\n */\nplayVideo(media: any, player: YT.Player) {\n    const /** @type {?} */ id = media.id.videoId ? media.id.videoId : media.id;\n    player.loadVideoById(id);\n    this.play(player);\n  }\n/**\n * @param {?} player\n * @return {?}\n */\nisPlaying (player: YT.Player) {\n    // because YT is not loaded yet 1 is used - YT.PlayerState.PLAYING\n    const /** @type {?} */ isPlayerReady: any = player && player.getPlayerState;\n    const /** @type {?} */ playerState = isPlayerReady ? player.getPlayerState() : {};\n    const /** @type {?} */ isPlayerPlaying = isPlayerReady\n      ? playerState !== YT.PlayerState.ENDED && playerState !== YT.PlayerState.PAUSED\n      : false;\n    return isPlayerPlaying;\n  }\n/**\n * @param {?} elementId\n * @param {?} outputs\n * @param {?} sizes\n * @param {?=} videoId\n * @param {?=} playerVars\n * @return {?}\n */\ncreatePlayer (\n    elementId: string, outputs: IPlayerOutputs, sizes: IPlayerSize,\n    videoId = '', playerVars: YT.PlayerVars = {}) {\n    const /** @type {?} */ service = this;\n    const /** @type {?} */ playerSize = {\n      height: sizes.height || this.defaultSizes.height,\n      width: sizes.width || this.defaultSizes.width\n    };\n    return new YoutubePlayerService.Player(elementId, Object.assign({}, playerSize, {\n      events: {\n          onReady: (ev: YT.PlayerEvent) => {\n            this.zone.run(() => outputs.ready && outputs.ready.next(ev.target));\n          },\n          onStateChange: (ev: YT.PlayerEvent) => {\n            this.zone.run(() => outputs.change && outputs.change.next(ev));\n            // this.zone.run(() => onPlayerStateChange(ev));\n          }\n      },\n      videoId,\n      playerVars,\n    }));\n\n    // TODO: DEPRECATE?\n    // function onPlayerStateChange (event: any) {\n    //   const state = event.data;\n    //   const PlayerState = YoutubePlayerService.YT.PlayerState;\n    //   // play the next song if its not the end of the playlist\n    //   // should add a \"repeat\" feature\n    //   if (state === PlayerState.ENDED) {\n\n    //   }\n\n    //   if (state === PlayerState.PAUSED) {\n    //       // service.playerState = PlayerState.PAUSED;\n    //   }\n    //   if (state === PlayerState.PLAYING) {\n    //       // service.playerState = PlayerState.PLAYING;\n    //   }\n    // }\n  }\n/**\n * @param {?} player\n * @param {?} isFullScreen\n * @return {?}\n */\ntoggleFullScreen (player: YT.Player, isFullScreen: boolean | null | undefined) {\n    let { height, width } = this.defaultSizes;\n\n    if (!isFullScreen) {\n      height = window.innerHeight;\n      width = window.innerWidth;\n    }\n    player.setSize(width, height);\n    // TODO: dispatch event\n  }\n/**\n * @return {?}\n */\ngenerateUniqueId () {\n    const /** @type {?} */ len = 7;\n    return Math.random().toString(35).substr(2, len);\n  }\n/**\n * @return {?}\n */\nprivate createApi () {\n    this.api = new ReplaySubject(1);\n    const /** @type {?} */ onYouTubeIframeAPIReady = () => {\n      if (YoutubePlayerService.win) {\n        this.api.next( /** @type {?} */((<any> YoutubePlayerService.YT)));\n      }\n    };\n    YoutubePlayerService.win['onYouTubeIframeAPIReady'] = onYouTubeIframeAPIReady;\n  }\nstatic decorators: DecoratorInvocation[] = [\n{ type: Injectable },\n];\n/**\n * @nocollapse\n */\nstatic ctorParameters: () => ({type: any, decorators?: DecoratorInvocation[]}|null)[] = () => [\n{type: NgZone, },\n];\n}\n\nfunction YoutubePlayerService_tsickle_Closure_declarations() {\n/** @type {?} */\nYoutubePlayerService.decorators;\n/**\n * @nocollapse\n * @type {?}\n */\nYoutubePlayerService.ctorParameters;\n/** @type {?} */\nYoutubePlayerService.prototype.api;\n/** @type {?} */\nYoutubePlayerService.prototype.isFullscreen;\n/** @type {?} */\nYoutubePlayerService.prototype.defaultSizes;\n/** @type {?} */\nYoutubePlayerService.prototype.zone;\n}\n\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n","import {\n  Component, EventEmitter, Input, Output, ChangeDetectionStrategy,\n  AfterContentInit, ElementRef, ViewChild\n} from '@angular/core';\nimport { YoutubePlayerService } from '../services/youtube-player.service';\nexport class YoutubePlayerComponent implements AfterContentInit {\n   videoId = '';\n   height: number;\n   width: number;\n/**\n * \\@description sets the protocol by the navigator object\n * if there is no window, it sets a default http protocol\n * unless the protocol is set from outside\n */\nprotocol: string = this.getProtocol();\n   playerVars: YT.PlayerVars = {};\n\n  // player created and initialized - sends instance of the player\n   ready = new EventEmitter<YT.Player>();\n  // state change: send the YT event with its state\n   change = new EventEmitter<YT.PlayerEvent>();\npublic ytPlayerContainer: ElementRef;\n/**\n * @param {?} playerService\n * @param {?} elementRef\n */\nconstructor(\npublic playerService: YoutubePlayerService,\nprivate elementRef: ElementRef\n  ) {}\n/**\n * @return {?}\n */\nngAfterContentInit () {\n    const /** @type {?} */ htmlId = this.playerService.generateUniqueId();\n    const /** @type {?} */ playerSize = { height: this.height, width: this.width };\n    this.ytPlayerContainer.nativeElement.setAttribute('id', htmlId);\n    this.playerService.loadPlayerApi({\n      protocol: this.protocol\n    });\n    this.playerService.setupPlayer(htmlId, {\n      change: this.change,\n      ready: this.ready,\n    }, playerSize, this.videoId, this.playerVars);\n  }\n/**\n * @return {?}\n */\ngetProtocol() {\n    const /** @type {?} */ hasWindow = window && window.location;\n    const /** @type {?} */ protocol = hasWindow\n      ? window.location.protocol.replace(':', '')\n      : 'http';\n    return protocol;\n  }\nstatic decorators: DecoratorInvocation[] = [\n{ type: Component, args: [{\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  selector: 'youtube-player',\n  template: `\n    <div id=\"yt-player-ng2-component\" #ytPlayerContainer></div>\n  `,\n}, ] },\n];\n/**\n * @nocollapse\n */\nstatic ctorParameters: () => ({type: any, decorators?: DecoratorInvocation[]}|null)[] = () => [\n{type: YoutubePlayerService, },\n{type: ElementRef, },\n];\nstatic propDecorators: {[key: string]: DecoratorInvocation[]} = {\n'videoId': [{ type: Input },],\n'height': [{ type: Input },],\n'width': [{ type: Input },],\n'protocol': [{ type: Input },],\n'playerVars': [{ type: Input },],\n'ready': [{ type: Output },],\n'change': [{ type: Output },],\n'ytPlayerContainer': [{ type: ViewChild, args: ['ytPlayerContainer', ] },],\n};\n}\n\nfunction YoutubePlayerComponent_tsickle_Closure_declarations() {\n/** @type {?} */\nYoutubePlayerComponent.decorators;\n/**\n * @nocollapse\n * @type {?}\n */\nYoutubePlayerComponent.ctorParameters;\n/** @type {?} */\nYoutubePlayerComponent.propDecorators;\n/** @type {?} */\nYoutubePlayerComponent.prototype.videoId;\n/** @type {?} */\nYoutubePlayerComponent.prototype.height;\n/** @type {?} */\nYoutubePlayerComponent.prototype.width;\n/**\n * \\@description sets the protocol by the navigator object\n * if there is no window, it sets a default http protocol\n * unless the protocol is set from outside\n * @type {?}\n */\nYoutubePlayerComponent.prototype.protocol;\n/** @type {?} */\nYoutubePlayerComponent.prototype.playerVars;\n/** @type {?} */\nYoutubePlayerComponent.prototype.ready;\n/** @type {?} */\nYoutubePlayerComponent.prototype.change;\n/** @type {?} */\nYoutubePlayerComponent.prototype.ytPlayerContainer;\n/** @type {?} */\nYoutubePlayerComponent.prototype.playerService;\n/** @type {?} */\nYoutubePlayerComponent.prototype.elementRef;\n}\n\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\n\nimport { YoutubePlayerComponent } from './youtube-player.component';\nimport { YoutubePlayerService } from '../services/youtube-player.service';\nexport class YoutubePlayerModule { static decorators: DecoratorInvocation[] = [\n{ type: NgModule, args: [{\n  declarations: [\n    YoutubePlayerComponent\n  ],\n  exports: [\n    YoutubePlayerComponent\n  ],\n  imports: [\n    CommonModule\n  ],\n  providers: [\n    YoutubePlayerService\n  ]\n}, ] },\n];\n/**\n * @nocollapse\n */\nstatic ctorParameters: () => ({type: any, decorators?: DecoratorInvocation[]}|null)[] = () => [\n];\n}\n\nfunction YoutubePlayerModule_tsickle_Closure_declarations() {\n/** @type {?} */\nYoutubePlayerModule.decorators;\n/**\n * @nocollapse\n * @type {?}\n */\nYoutubePlayerModule.ctorParameters;\n}\n\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"],"names":["YoutubePlayerService","zone","this","isFullscreen","defaultSizes","height","width","createApi","Object","defineProperty","get","window","win","YT","Player","prototype","loadPlayerApi","options","doc","document","playerApiScript","createElement","type","src","protocol","body","appendChild","setupPlayer","elementId","outputs","sizes","videoId","playerVars","_this","createPlayer","api","subscribe","play","player","playVideo","pause","pauseVideo","media","id","loadVideoById","isPlaying","isPlayerReady","getPlayerState","playerState","PlayerState","ENDED","PAUSED","playerSize","assign","events","onReady","ev","run","ready","next","target","onStateChange","change","toggleFullScreen","isFullScreen","_a","innerHeight","innerWidth","setSize","generateUniqueId","Math","random","toString","substr","ReplaySubject","onYouTubeIframeAPIReady","decorators","Injectable","ctorParameters","NgZone","YoutubePlayerComponent","playerService","elementRef","getProtocol","EventEmitter","ngAfterContentInit","htmlId","ytPlayerContainer","nativeElement","setAttribute","location","replace","Component","args","changeDetection","ChangeDetectionStrategy","OnPush","selector","template","ElementRef","propDecorators","Input","Output","ViewChild","YoutubePlayerModule","NgModule","declarations","exports","imports","CommonModule","providers"],"mappings":"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"}