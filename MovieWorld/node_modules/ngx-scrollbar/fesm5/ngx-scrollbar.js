import { Component, Inject, Input, Output, ViewChild, ChangeDetectionStrategy, EventEmitter, Renderer2, ViewEncapsulation, NgZone, NgModule } from '@angular/core';
import { DOCUMENT, CommonModule } from '@angular/common';
import { fromEvent, of, EMPTY } from 'rxjs';
import { delay, expand, map, mergeMap, takeUntil, takeWhile, tap } from 'rxjs/operators';
import { ObserversModule } from '@angular/cdk/observers';

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */
var ScrollbarComponent = /** @class */ (function () {
    function ScrollbarComponent(zone, renderer, document) {
        this.zone = zone;
        this.renderer = renderer;
        this.document = document;
        this._thumbSizeY = 0;
        this._thumbSizeX = 0;
        this._trackTopMax = 0;
        this._trackLeftMax = 0;
        this._scrollLeftMax = 0;
        this._scrollTopMax = 0;
        this._naturalThumbSizeY = 0;
        this._naturalThumbSizeX = 0;
        this._currXPos = 0;
        this._currYPos = 0;
        this._minThumbSize = 20;
        this.autoUpdate = true;
        this.autoHide = false;
        this.trackX = false;
        this.trackY = true;
        this.scrollState = new EventEmitter();
    }
    /**
     * @return {?}
     */
    ScrollbarComponent.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.zone.runOutsideAngular(function () {
            _this.barX = _this.barXRef.nativeElement;
            _this.barY = _this.barYRef.nativeElement;
            _this.thumbX = _this.thumbXRef.nativeElement;
            _this.thumbY = _this.thumbYRef.nativeElement;
            _this.view = _this.viewRef.nativeElement;
            _this.hideNativeScrollbars();
            /** Initialize scrollbars */
            /** Initialize scrollbars */
            _this.scrollWorker(null);
            _this._scrollSub$ = fromEvent(_this.view, 'scroll').pipe(tap(function (e) { return _this.scrollWorker(e); })).subscribe();
            if (_this.trackX) {
                _this._barXSub$ = fromEvent(_this.barX, 'mousedown').pipe(tap(function (e) { return _this.barXWorker(e); })).subscribe();
                _this._thumbXSub$ = _this.startThumbXWorker();
            }
            if (_this.trackY) {
                _this._barYSub$ = fromEvent(_this.barY, 'mousedown').pipe(tap(function (e) { return _this.barYWorker(e); })).subscribe();
                _this._thumbYSub$ = _this.startThumbYWorker();
            }
        });
    };
    /**
     * @return {?}
     */
    ScrollbarComponent.prototype.ngOnDestroy = /**
     * @return {?}
     */
    function () {
        if (this._scrollSub$) {
            this._scrollSub$.unsubscribe();
        }
        if (this.trackX) {
            this._barXSub$.unsubscribe();
            this._thumbXSub$.unsubscribe();
        }
        if (this.trackY) {
            this._barYSub$.unsubscribe();
            this._thumbYSub$.unsubscribe();
        }
    };
    /**
     * Scroll horizontally
     * @param to
     * @param duration
     */
    /**
     * Scroll horizontally
     * @param {?} to
     * @param {?=} duration
     * @return {?}
     */
    ScrollbarComponent.prototype.scrollXTo = /**
     * Scroll horizontally
     * @param {?} to
     * @param {?=} duration
     * @return {?}
     */
    function (to, duration) {
        var _this = this;
        if (duration) {
            of(duration).pipe(takeWhile(function () { return duration > 0; }), expand(function (d) {
                if (d > 0) {
                    var /** @type {?} */ difference = to - _this.view.scrollLeft;
                    var /** @type {?} */ perTick = difference / d * 10;
                    _this.renderer.setProperty(_this.view, 'scrollLeft', _this.view.scrollLeft + perTick);
                    return of(d - 10).pipe(delay(10));
                }
                else {
                    duration = d;
                    return EMPTY;
                }
            })).subscribe();
        }
        else {
            this.renderer.setProperty(this.view, 'scrollLeft', to);
        }
    };
    /**
     * Scroll vertically
     * @param to
     * @param duration
     */
    /**
     * Scroll vertically
     * @param {?} to
     * @param {?=} duration
     * @return {?}
     */
    ScrollbarComponent.prototype.scrollYTo = /**
     * Scroll vertically
     * @param {?} to
     * @param {?=} duration
     * @return {?}
     */
    function (to, duration) {
        var _this = this;
        if (duration) {
            of(duration).pipe(takeWhile(function () { return duration > 0; }), expand(function (d) {
                if (d > 0) {
                    var /** @type {?} */ difference = to - _this.view.scrollTop;
                    var /** @type {?} */ perTick = difference / d * 10;
                    _this.renderer.setProperty(_this.view, 'scrollTop', _this.view.scrollTop + perTick);
                    return of(d - 10).pipe(delay(10));
                }
                else {
                    duration = d;
                    return EMPTY;
                }
            })).subscribe();
        }
        else {
            this.renderer.setProperty(this.view, 'scrollTop', to);
        }
    };
    /**
     * Scroll view to top
     * @param duration
     */
    /**
     * Scroll view to top
     * @param {?=} duration
     * @return {?}
     */
    ScrollbarComponent.prototype.scrollToTop = /**
     * Scroll view to top
     * @param {?=} duration
     * @return {?}
     */
    function (duration) {
        this.scrollYTo(0, duration);
    };
    /**
     * Scroll view to bottom
     * @param duration
     */
    /**
     * Scroll view to bottom
     * @param {?=} duration
     * @return {?}
     */
    ScrollbarComponent.prototype.scrollToBottom = /**
     * Scroll view to bottom
     * @param {?=} duration
     * @return {?}
     */
    function (duration) {
        this.scrollYTo(this.view.scrollHeight, duration);
    };
    /**
     * Scroll view to max right
     * @param duration
     */
    /**
     * Scroll view to max right
     * @param {?=} duration
     * @return {?}
     */
    ScrollbarComponent.prototype.scrollToRight = /**
     * Scroll view to max right
     * @param {?=} duration
     * @return {?}
     */
    function (duration) {
        this.scrollXTo(this.view.scrollWidth, duration);
    };
    /**
     * Scroll view to max left
     * @param duration
     */
    /**
     * Scroll view to max left
     * @param {?=} duration
     * @return {?}
     */
    ScrollbarComponent.prototype.scrollToLeft = /**
     * Scroll view to max left
     * @param {?=} duration
     * @return {?}
     */
    function (duration) {
        this.scrollXTo(0, duration);
    };
    /**
     * Update thumbnails
     */
    /**
     * Update thumbnails
     * @return {?}
     */
    ScrollbarComponent.prototype.update = /**
     * Update thumbnails
     * @return {?}
     */
    function () {
        this.setThumbXPosition(this._currXPos, this.calculateThumbXSize());
        this.setThumbYPosition(this._currYPos, this.calculateThumbYSize());
    };
    /**
     * Scroll Worker
     * @param {?} e - Mouse Event
     * @return {?}
     */
    ScrollbarComponent.prototype.scrollWorker = /**
     * Scroll Worker
     * @param {?} e - Mouse Event
     * @return {?}
     */
    function (e) {
        this._thumbSizeX = this.thumbX.clientWidth;
        this._thumbSizeY = this.thumbY.clientHeight;
        this._trackLeftMax = this.barX.clientWidth - this._thumbSizeX;
        this._trackTopMax = this.barY.clientHeight - this._thumbSizeY;
        var /** @type {?} */ thumbXPosition = this.view.scrollLeft * this._trackLeftMax / this._scrollLeftMax;
        var /** @type {?} */ thumbYPosition = this.view.scrollTop * this._trackTopMax / this._scrollTopMax;
        this.setThumbXPosition(thumbXPosition, this.calculateThumbXSize());
        this.setThumbYPosition(thumbYPosition, this.calculateThumbYSize());
        /** Emit scroll state */
        this.scrollState.emit(e);
    };
    /**
     * Horizontal scrollbar click worker
     * @param {?} e - Mouse Event
     * @return {?}
     */
    ScrollbarComponent.prototype.barXWorker = /**
     * Horizontal scrollbar click worker
     * @param {?} e - Mouse Event
     * @return {?}
     */
    function (e) {
        if (e.target === e.currentTarget) {
            var /** @type {?} */ offset = e.offsetX - this._naturalThumbSizeX * .5;
            var /** @type {?} */ thumbPositionPercentage = offset * 100 / this.barX.clientWidth;
            var /** @type {?} */ scrollLeft = thumbPositionPercentage * this.view.scrollWidth / 100;
            this.renderer.setProperty(this.view, 'scrollLeft', scrollLeft);
        }
    };
    /**
     * Vertical scrollbar click worker
     * @param {?} e - Mouse Event
     * @return {?}
     */
    ScrollbarComponent.prototype.barYWorker = /**
     * Vertical scrollbar click worker
     * @param {?} e - Mouse Event
     * @return {?}
     */
    function (e) {
        if (e.target === e.currentTarget) {
            var /** @type {?} */ offset = e.offsetY - this._naturalThumbSizeY * .5;
            var /** @type {?} */ thumbPositionPercentage = offset * 100 / this.barY.clientHeight;
            var /** @type {?} */ scrollTop = thumbPositionPercentage * this.view.scrollHeight / 100;
            this.renderer.setProperty(this.view, 'scrollTop', scrollTop);
        }
    };
    /**
     * Start horizontal thumb worker
     * @return {?}
     */
    ScrollbarComponent.prototype.startThumbXWorker = /**
     * Start horizontal thumb worker
     * @return {?}
     */
    function () {
        var _this = this;
        var /** @type {?} */ mousedown$ = fromEvent(this.thumbX, 'mousedown');
        var /** @type {?} */ mouseup$ = fromEvent(this.document, 'mouseup');
        var /** @type {?} */ mousemove$ = fromEvent(this.document, 'mousemove');
        return mousedown$.pipe(tap(function () { return _this.document.onselectstart = function () { return false; }; }), map(function (mousedownEvent) { return mousedownEvent.offsetX; }), mergeMap(function (mousedownOffsetX) {
            return mousemove$.pipe(takeUntil(mouseup$.pipe(tap(function () { return _this.document.onselectstart = null; }))), map(function (mousemoveEvent) { return mousemoveEvent.clientX; }), tap(function (mousemoveClientX) {
                var /** @type {?} */ offset = mousemoveClientX - _this.barX.getBoundingClientRect().left;
                var /** @type {?} */ scroll = _this._scrollLeftMax * (offset - mousedownOffsetX) / _this._trackLeftMax;
                _this.renderer.setProperty(_this.view, 'scrollLeft', scroll);
            }));
        })).subscribe();
    };
    /**
     * Start vertical thumb worker
     * @return {?}
     */
    ScrollbarComponent.prototype.startThumbYWorker = /**
     * Start vertical thumb worker
     * @return {?}
     */
    function () {
        var _this = this;
        var /** @type {?} */ mousedown$ = fromEvent(this.thumbY, 'mousedown');
        var /** @type {?} */ mouseup$ = fromEvent(this.document, 'mouseup');
        var /** @type {?} */ mousemove$ = fromEvent(this.document, 'mousemove');
        return mousedown$.pipe(tap(function () { return _this.document.onselectstart = function () { return false; }; }), map(function (mousedownEvent) { return mousedownEvent.offsetY; }), mergeMap(function (mousedownOffsetY) {
            return mousemove$.pipe(takeUntil(mouseup$.pipe(tap(function () { return _this.document.onselectstart = null; }))), map(function (mousemoveEvent) { return mousemoveEvent.clientY; }), tap(function (mousemoveClientY) {
                var /** @type {?} */ offset = mousemoveClientY - _this.barY.getBoundingClientRect().top;
                var /** @type {?} */ scroll = _this._scrollTopMax * (offset - mousedownOffsetY) / _this._trackTopMax;
                _this.renderer.setProperty(_this.view, 'scrollTop', scroll);
            }));
        })).subscribe();
    };
    /**
     * Calculate Thumb X Size
     * @return {?}
     */
    ScrollbarComponent.prototype.calculateThumbXSize = /**
     * Calculate Thumb X Size
     * @return {?}
     */
    function () {
        this._naturalThumbSizeX = this.barX.clientWidth / this.view.scrollWidth * this.barX.clientWidth;
        this._scrollLeftMax = this.view.scrollWidth - this.view.clientWidth;
        return this.scrollBoundaries(this._naturalThumbSizeX, this._scrollLeftMax);
    };
    /**
     * Calculate Thumb Y Size
     * @return {?}
     */
    ScrollbarComponent.prototype.calculateThumbYSize = /**
     * Calculate Thumb Y Size
     * @return {?}
     */
    function () {
        this._naturalThumbSizeY = this.barY.clientHeight / this.view.scrollHeight * this.barY.clientHeight;
        this._scrollTopMax = this.view.scrollHeight - this.view.clientHeight;
        return this.scrollBoundaries(this._naturalThumbSizeY, this._scrollTopMax);
    };
    /**
     * Get scrollbar thumb size
     * @param {?} naturalThumbSize
     * @param {?} scrollMax
     * @return {?}
     */
    ScrollbarComponent.prototype.scrollBoundaries = /**
     * Get scrollbar thumb size
     * @param {?} naturalThumbSize
     * @param {?} scrollMax
     * @return {?}
     */
    function (naturalThumbSize, scrollMax) {
        return (naturalThumbSize < this._minThumbSize) ? this._minThumbSize : scrollMax ? naturalThumbSize : 0;
    };
    /**
     * Set horizontal scrollbar thumb style
     * @param {?} x
     * @param {?} width
     * @return {?}
     */
    ScrollbarComponent.prototype.setThumbXPosition = /**
     * Set horizontal scrollbar thumb style
     * @param {?} x
     * @param {?} width
     * @return {?}
     */
    function (x, width) {
        var /** @type {?} */ transform = "translate3d(" + x + "px, 0, 0)";
        this.renderer.setStyle(this.thumbX, 'transform', transform);
        this.renderer.setStyle(this.thumbX, 'width', width + 'px');
        this._currXPos = x;
    };
    /**
     * Set vertical scrollbar thumb style
     * @param {?} y
     * @param {?} height
     * @return {?}
     */
    ScrollbarComponent.prototype.setThumbYPosition = /**
     * Set vertical scrollbar thumb style
     * @param {?} y
     * @param {?} height
     * @return {?}
     */
    function (y, height) {
        var /** @type {?} */ transform = "translate3d(0, " + y + "px, 0)";
        this.renderer.setStyle(this.thumbY, 'transform', transform);
        this.renderer.setStyle(this.thumbY, 'height', height + 'px');
        this._currYPos = y;
    };
    /**
     * Hide native scrollbars
     * @return {?}
     */
    ScrollbarComponent.prototype.hideNativeScrollbars = /**
     * Hide native scrollbars
     * @return {?}
     */
    function () {
        var /** @type {?} */ size = "calc(100% + " + this.getNativeScrollbarWidth() + "px)";
        this.renderer.setStyle(this.view, 'width', size);
        this.renderer.setStyle(this.view, 'height', size);
    };
    /**
     * Get the native scrollbar width
     * @return {?}
     */
    ScrollbarComponent.prototype.getNativeScrollbarWidth = /**
     * Get the native scrollbar width
     * @return {?}
     */
    function () {
        var /** @type {?} */ element = this.document.createElement('div');
        element.style.position = 'absolute';
        element.style.top = '-9999px';
        element.style.width = '100px';
        element.style.height = '100px';
        element.style.overflow = 'scroll';
        element.style.msOverflowStyle = 'scrollbar';
        this.document.body.appendChild(element);
        var /** @type {?} */ sw = element.offsetWidth - element.clientWidth;
        this.document.body.removeChild(element);
        return sw;
    };
    ScrollbarComponent.decorators = [
        { type: Component, args: [{
                    selector: 'ng-scrollbar',
                    template: "<div class=\"ng-scrollbar-container\" [class.ng-scrollbar-autohide]=\"autoHide\">\n\n  <div #barX class=\"ng-scrollbar -horizontal {{barClass}}\" [class.ng-scrollbar-disabled]=\"!trackX\">\n    <div #thumbX class=\"ng-scrollbar-thumb {{thumbClass}}\"></div>\n  </div>\n\n  <div #barY class=\"ng-scrollbar -vertical {{barClass}}\" [class.ng-scrollbar-disabled]=\"!trackY\">\n    <div #thumbY class=\"ng-scrollbar-thumb {{thumbClass}}\"></div>\n  </div>\n\n  <div #view class=\"ng-scrollbar-view {{viewClass}}\"\n       (cdkObserveContent)=\"update()\"\n       [cdkObserveContentDisabled]=\"autoUpdate\">\n    <ng-content></ng-content>\n  </div>\n</div>\n",
                    styles: ["ng-scrollbar{display:block;position:relative;height:100%;overflow:hidden!important}.ng-scrollbar-container{position:relative;overflow:hidden!important;width:100%;height:100%}.ng-scrollbar-autohide>.ng-scrollbar{opacity:0;transition:opacity 120ms ease-out}.ng-scrollbar-autohide:active>.ng-scrollbar,.ng-scrollbar-autohide:focus>.ng-scrollbar,.ng-scrollbar-autohide:hover>.ng-scrollbar{opacity:1;transition:opacity 340ms ease-out}.ng-scrollbar{position:absolute;right:2px;bottom:2px;z-index:1;border-radius:3px}.-vertical{width:6px;top:2px}.-vertical .ng-scrollbar-thumb{width:100%}.-horizontal{height:6px;left:2px}.-horizontal .ng-scrollbar-thumb{height:100%}.ng-scrollbar-disabled{display:none}.ng-scrollbar-thumb{position:relative;display:block;width:0;height:0;border-radius:inherit;background-color:rgba(0,0,0,.2);-webkit-transform:translate3d(0,0,0);transform:translate3d(0,0,0)}.ng-scrollbar-thumb:active,.ng-scrollbar-thumb:hover{background-color:rgba(0,0,0,.3)}.ng-scrollbar-view{width:100%;height:100%;overflow:scroll;-webkit-transform:translate3d(0,0,0);transform:translate3d(0,0,0);-webkit-overflow-scrolling:touch}"],
                    changeDetection: ChangeDetectionStrategy.OnPush,
                    encapsulation: ViewEncapsulation.None,
                    preserveWhitespaces: false
                },] },
    ];
    /** @nocollapse */
    ScrollbarComponent.ctorParameters = function () { return [
        { type: NgZone, },
        { type: Renderer2, },
        { type: undefined, decorators: [{ type: Inject, args: [DOCUMENT,] },] },
    ]; };
    ScrollbarComponent.propDecorators = {
        "barXRef": [{ type: ViewChild, args: ['barX',] },],
        "barYRef": [{ type: ViewChild, args: ['barY',] },],
        "thumbXRef": [{ type: ViewChild, args: ['thumbX',] },],
        "thumbYRef": [{ type: ViewChild, args: ['thumbY',] },],
        "viewRef": [{ type: ViewChild, args: ['view',] },],
        "autoUpdate": [{ type: Input },],
        "autoHide": [{ type: Input },],
        "trackX": [{ type: Input },],
        "trackY": [{ type: Input },],
        "viewClass": [{ type: Input },],
        "barClass": [{ type: Input },],
        "thumbClass": [{ type: Input },],
        "scrollState": [{ type: Output },],
    };
    return ScrollbarComponent;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */
var ScrollbarModule = /** @class */ (function () {
    function ScrollbarModule() {
    }
    ScrollbarModule.decorators = [
        { type: NgModule, args: [{
                    imports: [
                        CommonModule,
                        ObserversModule
                    ],
                    declarations: [ScrollbarComponent],
                    exports: [ScrollbarComponent]
                },] },
    ];
    return ScrollbarModule;
}());

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */

export { ScrollbarModule, ScrollbarComponent };

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmd4LXNjcm9sbGJhci5qcy5tYXAiLCJzb3VyY2VzIjpbIm5nOi8vbmd4LXNjcm9sbGJhci9saWIvc2Nyb2xsYmFyLmNvbXBvbmVudC50cyIsIm5nOi8vbmd4LXNjcm9sbGJhci9saWIvc2Nyb2xsYmFyLm1vZHVsZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xyXG4gIENvbXBvbmVudCxcclxuICBJbmplY3QsXHJcbiAgQWZ0ZXJWaWV3SW5pdCxcclxuICBPbkRlc3Ryb3ksXHJcbiAgSW5wdXQsXHJcbiAgT3V0cHV0LFxyXG4gIFZpZXdDaGlsZCxcclxuICBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneSxcclxuICBFdmVudEVtaXR0ZXIsXHJcbiAgUmVuZGVyZXIyLFxyXG4gIFZpZXdFbmNhcHN1bGF0aW9uLFxyXG4gIE5nWm9uZVxyXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBET0NVTUVOVCB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbic7XHJcbmltcG9ydCB7IFN1YnNjcmlwdGlvbiwgZnJvbUV2ZW50LCBvZiwgRU1QVFkgfSBmcm9tICdyeGpzJztcclxuaW1wb3J0IHsgZGVsYXksIGV4cGFuZCwgbWFwLCBtZXJnZU1hcCwgdGFrZVVudGlsLCB0YWtlV2hpbGUsIHRhcCB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcclxuXHJcbkBDb21wb25lbnQoe1xyXG4gIHNlbGVjdG9yOiAnbmctc2Nyb2xsYmFyJyxcclxuICB0ZW1wbGF0ZTogYDxkaXYgY2xhc3M9XCJuZy1zY3JvbGxiYXItY29udGFpbmVyXCIgW2NsYXNzLm5nLXNjcm9sbGJhci1hdXRvaGlkZV09XCJhdXRvSGlkZVwiPlxyXG5cclxuICA8ZGl2ICNiYXJYIGNsYXNzPVwibmctc2Nyb2xsYmFyIC1ob3Jpem9udGFsIHt7YmFyQ2xhc3N9fVwiIFtjbGFzcy5uZy1zY3JvbGxiYXItZGlzYWJsZWRdPVwiIXRyYWNrWFwiPlxyXG4gICAgPGRpdiAjdGh1bWJYIGNsYXNzPVwibmctc2Nyb2xsYmFyLXRodW1iIHt7dGh1bWJDbGFzc319XCI+PC9kaXY+XHJcbiAgPC9kaXY+XHJcblxyXG4gIDxkaXYgI2JhclkgY2xhc3M9XCJuZy1zY3JvbGxiYXIgLXZlcnRpY2FsIHt7YmFyQ2xhc3N9fVwiIFtjbGFzcy5uZy1zY3JvbGxiYXItZGlzYWJsZWRdPVwiIXRyYWNrWVwiPlxyXG4gICAgPGRpdiAjdGh1bWJZIGNsYXNzPVwibmctc2Nyb2xsYmFyLXRodW1iIHt7dGh1bWJDbGFzc319XCI+PC9kaXY+XHJcbiAgPC9kaXY+XHJcblxyXG4gIDxkaXYgI3ZpZXcgY2xhc3M9XCJuZy1zY3JvbGxiYXItdmlldyB7e3ZpZXdDbGFzc319XCJcclxuICAgICAgIChjZGtPYnNlcnZlQ29udGVudCk9XCJ1cGRhdGUoKVwiXHJcbiAgICAgICBbY2RrT2JzZXJ2ZUNvbnRlbnREaXNhYmxlZF09XCJhdXRvVXBkYXRlXCI+XHJcbiAgICA8bmctY29udGVudD48L25nLWNvbnRlbnQ+XHJcbiAgPC9kaXY+XHJcbjwvZGl2PlxyXG5gLFxyXG4gIHN0eWxlczogW2BuZy1zY3JvbGxiYXJ7ZGlzcGxheTpibG9jaztwb3NpdGlvbjpyZWxhdGl2ZTtoZWlnaHQ6MTAwJTtvdmVyZmxvdzpoaWRkZW4haW1wb3J0YW50fS5uZy1zY3JvbGxiYXItY29udGFpbmVye3Bvc2l0aW9uOnJlbGF0aXZlO292ZXJmbG93OmhpZGRlbiFpbXBvcnRhbnQ7d2lkdGg6MTAwJTtoZWlnaHQ6MTAwJX0ubmctc2Nyb2xsYmFyLWF1dG9oaWRlPi5uZy1zY3JvbGxiYXJ7b3BhY2l0eTowO3RyYW5zaXRpb246b3BhY2l0eSAxMjBtcyBlYXNlLW91dH0ubmctc2Nyb2xsYmFyLWF1dG9oaWRlOmFjdGl2ZT4ubmctc2Nyb2xsYmFyLC5uZy1zY3JvbGxiYXItYXV0b2hpZGU6Zm9jdXM+Lm5nLXNjcm9sbGJhciwubmctc2Nyb2xsYmFyLWF1dG9oaWRlOmhvdmVyPi5uZy1zY3JvbGxiYXJ7b3BhY2l0eToxO3RyYW5zaXRpb246b3BhY2l0eSAzNDBtcyBlYXNlLW91dH0ubmctc2Nyb2xsYmFye3Bvc2l0aW9uOmFic29sdXRlO3JpZ2h0OjJweDtib3R0b206MnB4O3otaW5kZXg6MTtib3JkZXItcmFkaXVzOjNweH0uLXZlcnRpY2Fse3dpZHRoOjZweDt0b3A6MnB4fS4tdmVydGljYWwgLm5nLXNjcm9sbGJhci10aHVtYnt3aWR0aDoxMDAlfS4taG9yaXpvbnRhbHtoZWlnaHQ6NnB4O2xlZnQ6MnB4fS4taG9yaXpvbnRhbCAubmctc2Nyb2xsYmFyLXRodW1ie2hlaWdodDoxMDAlfS5uZy1zY3JvbGxiYXItZGlzYWJsZWR7ZGlzcGxheTpub25lfS5uZy1zY3JvbGxiYXItdGh1bWJ7cG9zaXRpb246cmVsYXRpdmU7ZGlzcGxheTpibG9jazt3aWR0aDowO2hlaWdodDowO2JvcmRlci1yYWRpdXM6aW5oZXJpdDtiYWNrZ3JvdW5kLWNvbG9yOnJnYmEoMCwwLDAsLjIpOy13ZWJraXQtdHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMCwwKTt0cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApfS5uZy1zY3JvbGxiYXItdGh1bWI6YWN0aXZlLC5uZy1zY3JvbGxiYXItdGh1bWI6aG92ZXJ7YmFja2dyb3VuZC1jb2xvcjpyZ2JhKDAsMCwwLC4zKX0ubmctc2Nyb2xsYmFyLXZpZXd7d2lkdGg6MTAwJTtoZWlnaHQ6MTAwJTtvdmVyZmxvdzpzY3JvbGw7LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApO3RyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCk7LXdlYmtpdC1vdmVyZmxvdy1zY3JvbGxpbmc6dG91Y2h9YF0sXHJcbiAgY2hhbmdlRGV0ZWN0aW9uOiBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneS5PblB1c2gsXHJcbiAgZW5jYXBzdWxhdGlvbjogVmlld0VuY2Fwc3VsYXRpb24uTm9uZSxcclxuICBwcmVzZXJ2ZVdoaXRlc3BhY2VzOiBmYWxzZVxyXG59KVxyXG5leHBvcnQgY2xhc3MgU2Nyb2xsYmFyQ29tcG9uZW50IGltcGxlbWVudHMgQWZ0ZXJWaWV3SW5pdCwgT25EZXN0cm95IHtcclxuXHJcbiAgcHJpdmF0ZSBfdGh1bWJTaXplWSA9IDA7XHJcbiAgcHJpdmF0ZSBfdGh1bWJTaXplWCA9IDA7XHJcbiAgcHJpdmF0ZSBfdHJhY2tUb3BNYXggPSAwO1xyXG4gIHByaXZhdGUgX3RyYWNrTGVmdE1heCA9IDA7XHJcbiAgcHJpdmF0ZSBfc2Nyb2xsTGVmdE1heCA9IDA7XHJcbiAgcHJpdmF0ZSBfc2Nyb2xsVG9wTWF4ID0gMDtcclxuICBwcml2YXRlIF9uYXR1cmFsVGh1bWJTaXplWSA9IDA7XHJcbiAgcHJpdmF0ZSBfbmF0dXJhbFRodW1iU2l6ZVggPSAwO1xyXG4gIHByaXZhdGUgX2N1cnJYUG9zID0gMDtcclxuICBwcml2YXRlIF9jdXJyWVBvcyA9IDA7XHJcbiAgcHJpdmF0ZSBfbWluVGh1bWJTaXplID0gMjA7XHJcbiAgcHJpdmF0ZSBfc2Nyb2xsU3ViJDogU3Vic2NyaXB0aW9uO1xyXG4gIHByaXZhdGUgX2JhclhTdWIkOiBTdWJzY3JpcHRpb247XHJcbiAgcHJpdmF0ZSBfYmFyWVN1YiQ6IFN1YnNjcmlwdGlvbjtcclxuICBwcml2YXRlIF90aHVtYlhTdWIkOiBTdWJzY3JpcHRpb247XHJcbiAgcHJpdmF0ZSBfdGh1bWJZU3ViJDogU3Vic2NyaXB0aW9uO1xyXG5cclxuICBiYXJYOiBIVE1MRWxlbWVudDtcclxuICBiYXJZOiBIVE1MRWxlbWVudDtcclxuICB0aHVtYlg6IEhUTUxFbGVtZW50O1xyXG4gIHRodW1iWTogSFRNTEVsZW1lbnQ7XHJcbiAgdmlldzogSFRNTEVsZW1lbnQ7XHJcblxyXG4gIEBWaWV3Q2hpbGQoJ2JhclgnKSBiYXJYUmVmO1xyXG4gIEBWaWV3Q2hpbGQoJ2JhclknKSBiYXJZUmVmO1xyXG4gIEBWaWV3Q2hpbGQoJ3RodW1iWCcpIHRodW1iWFJlZjtcclxuICBAVmlld0NoaWxkKCd0aHVtYlknKSB0aHVtYllSZWY7XHJcbiAgQFZpZXdDaGlsZCgndmlldycpIHZpZXdSZWY7XHJcblxyXG4gIEBJbnB1dCgpIGF1dG9VcGRhdGUgPSB0cnVlO1xyXG4gIEBJbnB1dCgpIGF1dG9IaWRlID0gZmFsc2U7XHJcbiAgQElucHV0KCkgdHJhY2tYID0gZmFsc2U7XHJcbiAgQElucHV0KCkgdHJhY2tZID0gdHJ1ZTtcclxuICBASW5wdXQoKSB2aWV3Q2xhc3M6IHN0cmluZztcclxuICBASW5wdXQoKSBiYXJDbGFzczogc3RyaW5nO1xyXG4gIEBJbnB1dCgpIHRodW1iQ2xhc3M6IHN0cmluZztcclxuICBAT3V0cHV0KCkgc2Nyb2xsU3RhdGUgPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcclxuXHJcbiAgY29uc3RydWN0b3IocHJpdmF0ZSB6b25lOiBOZ1pvbmUsIHByaXZhdGUgcmVuZGVyZXI6IFJlbmRlcmVyMiwgQEluamVjdChET0NVTUVOVCkgcHJpdmF0ZSBkb2N1bWVudDogYW55KSB7XHJcbiAgfVxyXG5cclxuICBuZ0FmdGVyVmlld0luaXQoKSB7XHJcblxyXG4gICAgdGhpcy56b25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IHtcclxuICAgICAgdGhpcy5iYXJYID0gdGhpcy5iYXJYUmVmLm5hdGl2ZUVsZW1lbnQ7XHJcbiAgICAgIHRoaXMuYmFyWSA9IHRoaXMuYmFyWVJlZi5uYXRpdmVFbGVtZW50O1xyXG4gICAgICB0aGlzLnRodW1iWCA9IHRoaXMudGh1bWJYUmVmLm5hdGl2ZUVsZW1lbnQ7XHJcbiAgICAgIHRoaXMudGh1bWJZID0gdGhpcy50aHVtYllSZWYubmF0aXZlRWxlbWVudDtcclxuICAgICAgdGhpcy52aWV3ID0gdGhpcy52aWV3UmVmLm5hdGl2ZUVsZW1lbnQ7XHJcblxyXG4gICAgICB0aGlzLmhpZGVOYXRpdmVTY3JvbGxiYXJzKCk7XHJcblxyXG4gICAgICAvKiogSW5pdGlhbGl6ZSBzY3JvbGxiYXJzICovXHJcbiAgICAgIHRoaXMuc2Nyb2xsV29ya2VyKG51bGwpO1xyXG5cclxuICAgICAgdGhpcy5fc2Nyb2xsU3ViJCA9IGZyb21FdmVudCh0aGlzLnZpZXcsICdzY3JvbGwnKS5waXBlKHRhcCgoZSkgPT4gdGhpcy5zY3JvbGxXb3JrZXIoZSkpKS5zdWJzY3JpYmUoKTtcclxuICAgICAgaWYgKHRoaXMudHJhY2tYKSB7XHJcbiAgICAgICAgdGhpcy5fYmFyWFN1YiQgPSBmcm9tRXZlbnQodGhpcy5iYXJYLCAnbW91c2Vkb3duJykucGlwZSh0YXAoKGUpID0+IHRoaXMuYmFyWFdvcmtlcihlKSkpLnN1YnNjcmliZSgpO1xyXG4gICAgICAgIHRoaXMuX3RodW1iWFN1YiQgPSB0aGlzLnN0YXJ0VGh1bWJYV29ya2VyKCk7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKHRoaXMudHJhY2tZKSB7XHJcbiAgICAgICAgdGhpcy5fYmFyWVN1YiQgPSBmcm9tRXZlbnQodGhpcy5iYXJZLCAnbW91c2Vkb3duJykucGlwZSh0YXAoKGUpID0+IHRoaXMuYmFyWVdvcmtlcihlKSkpLnN1YnNjcmliZSgpO1xyXG4gICAgICAgIHRoaXMuX3RodW1iWVN1YiQgPSB0aGlzLnN0YXJ0VGh1bWJZV29ya2VyKCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgbmdPbkRlc3Ryb3koKSB7XHJcbiAgICBpZiAodGhpcy5fc2Nyb2xsU3ViJCkge1xyXG4gICAgICB0aGlzLl9zY3JvbGxTdWIkLnVuc3Vic2NyaWJlKCk7XHJcbiAgICB9XHJcbiAgICBpZiAodGhpcy50cmFja1gpIHtcclxuICAgICAgdGhpcy5fYmFyWFN1YiQudW5zdWJzY3JpYmUoKTtcclxuICAgICAgdGhpcy5fdGh1bWJYU3ViJC51bnN1YnNjcmliZSgpO1xyXG4gICAgfVxyXG4gICAgaWYgKHRoaXMudHJhY2tZKSB7XHJcbiAgICAgIHRoaXMuX2JhcllTdWIkLnVuc3Vic2NyaWJlKCk7XHJcbiAgICAgIHRoaXMuX3RodW1iWVN1YiQudW5zdWJzY3JpYmUoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFNjcm9sbCBob3Jpem9udGFsbHlcclxuICAgKiBAcGFyYW0gdG9cclxuICAgKiBAcGFyYW0gZHVyYXRpb25cclxuICAgKi9cclxuICBzY3JvbGxYVG8odG86IG51bWJlciwgZHVyYXRpb24/OiBudW1iZXIpIHtcclxuICAgIGlmIChkdXJhdGlvbikge1xyXG4gICAgICBvZihkdXJhdGlvbikucGlwZShcclxuICAgICAgICB0YWtlV2hpbGUoKCkgPT4gZHVyYXRpb24gPiAwKSxcclxuICAgICAgICBleHBhbmQoKGQ6IG51bWJlcikgPT4ge1xyXG4gICAgICAgICAgaWYgKGQgPiAwKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGRpZmZlcmVuY2UgPSB0byAtIHRoaXMudmlldy5zY3JvbGxMZWZ0O1xyXG4gICAgICAgICAgICBjb25zdCBwZXJUaWNrID0gZGlmZmVyZW5jZSAvIGQgKiAxMDtcclxuICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5zZXRQcm9wZXJ0eSh0aGlzLnZpZXcsICdzY3JvbGxMZWZ0JywgdGhpcy52aWV3LnNjcm9sbExlZnQgKyBwZXJUaWNrKTtcclxuICAgICAgICAgICAgcmV0dXJuIG9mKGQgLSAxMCkucGlwZShkZWxheSgxMCkpO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgZHVyYXRpb24gPSBkO1xyXG4gICAgICAgICAgICByZXR1cm4gRU1QVFk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgICAgKS5zdWJzY3JpYmUoKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMucmVuZGVyZXIuc2V0UHJvcGVydHkodGhpcy52aWV3LCAnc2Nyb2xsTGVmdCcsIHRvKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFNjcm9sbCB2ZXJ0aWNhbGx5XHJcbiAgICogQHBhcmFtIHRvXHJcbiAgICogQHBhcmFtIGR1cmF0aW9uXHJcbiAgICovXHJcbiAgc2Nyb2xsWVRvKHRvOiBudW1iZXIsIGR1cmF0aW9uPzogbnVtYmVyKSB7XHJcbiAgICBpZiAoZHVyYXRpb24pIHtcclxuICAgICAgb2YoZHVyYXRpb24pLnBpcGUoXHJcbiAgICAgICAgdGFrZVdoaWxlKCgpID0+IGR1cmF0aW9uID4gMCksXHJcbiAgICAgICAgZXhwYW5kKChkOiBudW1iZXIpID0+IHtcclxuICAgICAgICAgIGlmIChkID4gMCkge1xyXG4gICAgICAgICAgICBjb25zdCBkaWZmZXJlbmNlID0gdG8gLSB0aGlzLnZpZXcuc2Nyb2xsVG9wO1xyXG4gICAgICAgICAgICBjb25zdCBwZXJUaWNrID0gZGlmZmVyZW5jZSAvIGQgKiAxMDtcclxuICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5zZXRQcm9wZXJ0eSh0aGlzLnZpZXcsICdzY3JvbGxUb3AnLCB0aGlzLnZpZXcuc2Nyb2xsVG9wICsgcGVyVGljayk7XHJcbiAgICAgICAgICAgIHJldHVybiBvZihkIC0gMTApLnBpcGUoZGVsYXkoMTApKTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGR1cmF0aW9uID0gZDtcclxuICAgICAgICAgICAgcmV0dXJuIEVNUFRZO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICAgICkuc3Vic2NyaWJlKCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLnJlbmRlcmVyLnNldFByb3BlcnR5KHRoaXMudmlldywgJ3Njcm9sbFRvcCcsIHRvKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFNjcm9sbCB2aWV3IHRvIHRvcFxyXG4gICAqIEBwYXJhbSBkdXJhdGlvblxyXG4gICAqL1xyXG4gIHNjcm9sbFRvVG9wKGR1cmF0aW9uPzogbnVtYmVyKSB7XHJcbiAgICB0aGlzLnNjcm9sbFlUbygwLCBkdXJhdGlvbik7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBTY3JvbGwgdmlldyB0byBib3R0b21cclxuICAgKiBAcGFyYW0gZHVyYXRpb25cclxuICAgKi9cclxuICBzY3JvbGxUb0JvdHRvbShkdXJhdGlvbj86IG51bWJlcikge1xyXG4gICAgdGhpcy5zY3JvbGxZVG8odGhpcy52aWV3LnNjcm9sbEhlaWdodCwgZHVyYXRpb24pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogU2Nyb2xsIHZpZXcgdG8gbWF4IHJpZ2h0XHJcbiAgICogQHBhcmFtIGR1cmF0aW9uXHJcbiAgICovXHJcbiAgc2Nyb2xsVG9SaWdodChkdXJhdGlvbj86IG51bWJlcikge1xyXG4gICAgdGhpcy5zY3JvbGxYVG8odGhpcy52aWV3LnNjcm9sbFdpZHRoLCBkdXJhdGlvbik7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBTY3JvbGwgdmlldyB0byBtYXggbGVmdFxyXG4gICAqIEBwYXJhbSBkdXJhdGlvblxyXG4gICAqL1xyXG4gIHNjcm9sbFRvTGVmdChkdXJhdGlvbj86IG51bWJlcikge1xyXG4gICAgdGhpcy5zY3JvbGxYVG8oMCwgZHVyYXRpb24pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogVXBkYXRlIHRodW1ibmFpbHNcclxuICAgKi9cclxuICB1cGRhdGUoKSB7XHJcbiAgICB0aGlzLnNldFRodW1iWFBvc2l0aW9uKHRoaXMuX2N1cnJYUG9zLCB0aGlzLmNhbGN1bGF0ZVRodW1iWFNpemUoKSk7XHJcbiAgICB0aGlzLnNldFRodW1iWVBvc2l0aW9uKHRoaXMuX2N1cnJZUG9zLCB0aGlzLmNhbGN1bGF0ZVRodW1iWVNpemUoKSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBTY3JvbGwgV29ya2VyXHJcbiAgICogQHBhcmFtIGUgLSBNb3VzZSBFdmVudFxyXG4gICAqL1xyXG4gIHByaXZhdGUgc2Nyb2xsV29ya2VyKGU6IGFueSkge1xyXG4gICAgdGhpcy5fdGh1bWJTaXplWCA9IHRoaXMudGh1bWJYLmNsaWVudFdpZHRoO1xyXG4gICAgdGhpcy5fdGh1bWJTaXplWSA9IHRoaXMudGh1bWJZLmNsaWVudEhlaWdodDtcclxuXHJcbiAgICB0aGlzLl90cmFja0xlZnRNYXggPSB0aGlzLmJhclguY2xpZW50V2lkdGggLSB0aGlzLl90aHVtYlNpemVYO1xyXG4gICAgdGhpcy5fdHJhY2tUb3BNYXggPSB0aGlzLmJhclkuY2xpZW50SGVpZ2h0IC0gdGhpcy5fdGh1bWJTaXplWTtcclxuXHJcbiAgICBjb25zdCB0aHVtYlhQb3NpdGlvbiA9IHRoaXMudmlldy5zY3JvbGxMZWZ0ICogdGhpcy5fdHJhY2tMZWZ0TWF4IC8gdGhpcy5fc2Nyb2xsTGVmdE1heDtcclxuICAgIGNvbnN0IHRodW1iWVBvc2l0aW9uID0gdGhpcy52aWV3LnNjcm9sbFRvcCAqIHRoaXMuX3RyYWNrVG9wTWF4IC8gdGhpcy5fc2Nyb2xsVG9wTWF4O1xyXG5cclxuICAgIHRoaXMuc2V0VGh1bWJYUG9zaXRpb24odGh1bWJYUG9zaXRpb24sIHRoaXMuY2FsY3VsYXRlVGh1bWJYU2l6ZSgpKTtcclxuICAgIHRoaXMuc2V0VGh1bWJZUG9zaXRpb24odGh1bWJZUG9zaXRpb24sIHRoaXMuY2FsY3VsYXRlVGh1bWJZU2l6ZSgpKTtcclxuXHJcbiAgICAvKiogRW1pdCBzY3JvbGwgc3RhdGUgKi9cclxuICAgIHRoaXMuc2Nyb2xsU3RhdGUuZW1pdChlKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEhvcml6b250YWwgc2Nyb2xsYmFyIGNsaWNrIHdvcmtlclxyXG4gICAqIEBwYXJhbSBlIC0gTW91c2UgRXZlbnRcclxuICAgKi9cclxuICBwcml2YXRlIGJhclhXb3JrZXIoZTogYW55KSB7XHJcbiAgICBpZiAoZS50YXJnZXQgPT09IGUuY3VycmVudFRhcmdldCkge1xyXG4gICAgICBjb25zdCBvZmZzZXQgPSBlLm9mZnNldFggLSB0aGlzLl9uYXR1cmFsVGh1bWJTaXplWCAqIC41O1xyXG4gICAgICBjb25zdCB0aHVtYlBvc2l0aW9uUGVyY2VudGFnZSA9IG9mZnNldCAqIDEwMCAvIHRoaXMuYmFyWC5jbGllbnRXaWR0aDtcclxuICAgICAgY29uc3Qgc2Nyb2xsTGVmdCA9IHRodW1iUG9zaXRpb25QZXJjZW50YWdlICogdGhpcy52aWV3LnNjcm9sbFdpZHRoIC8gMTAwO1xyXG4gICAgICB0aGlzLnJlbmRlcmVyLnNldFByb3BlcnR5KHRoaXMudmlldywgJ3Njcm9sbExlZnQnLCBzY3JvbGxMZWZ0KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFZlcnRpY2FsIHNjcm9sbGJhciBjbGljayB3b3JrZXJcclxuICAgKiBAcGFyYW0gZSAtIE1vdXNlIEV2ZW50XHJcbiAgICovXHJcbiAgcHJpdmF0ZSBiYXJZV29ya2VyKGU6IGFueSkge1xyXG4gICAgaWYgKGUudGFyZ2V0ID09PSBlLmN1cnJlbnRUYXJnZXQpIHtcclxuICAgICAgY29uc3Qgb2Zmc2V0ID0gZS5vZmZzZXRZIC0gdGhpcy5fbmF0dXJhbFRodW1iU2l6ZVkgKiAuNTtcclxuICAgICAgY29uc3QgdGh1bWJQb3NpdGlvblBlcmNlbnRhZ2UgPSBvZmZzZXQgKiAxMDAgLyB0aGlzLmJhclkuY2xpZW50SGVpZ2h0O1xyXG4gICAgICBjb25zdCBzY3JvbGxUb3AgPSB0aHVtYlBvc2l0aW9uUGVyY2VudGFnZSAqIHRoaXMudmlldy5zY3JvbGxIZWlnaHQgLyAxMDA7XHJcbiAgICAgIHRoaXMucmVuZGVyZXIuc2V0UHJvcGVydHkodGhpcy52aWV3LCAnc2Nyb2xsVG9wJywgc2Nyb2xsVG9wKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFN0YXJ0IGhvcml6b250YWwgdGh1bWIgd29ya2VyXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBzdGFydFRodW1iWFdvcmtlcigpOiBTdWJzY3JpcHRpb24ge1xyXG4gICAgY29uc3QgbW91c2Vkb3duJCA9IGZyb21FdmVudCh0aGlzLnRodW1iWCwgJ21vdXNlZG93bicpO1xyXG4gICAgY29uc3QgbW91c2V1cCQgPSBmcm9tRXZlbnQodGhpcy5kb2N1bWVudCwgJ21vdXNldXAnKTtcclxuICAgIGNvbnN0IG1vdXNlbW92ZSQgPSBmcm9tRXZlbnQodGhpcy5kb2N1bWVudCwgJ21vdXNlbW92ZScpO1xyXG4gICAgcmV0dXJuIG1vdXNlZG93biQucGlwZShcclxuICAgICAgdGFwKCgpID0+IHRoaXMuZG9jdW1lbnQub25zZWxlY3RzdGFydCA9ICgpID0+IGZhbHNlKSxcclxuICAgICAgbWFwKChtb3VzZWRvd25FdmVudDogYW55KSA9PiBtb3VzZWRvd25FdmVudC5vZmZzZXRYKSxcclxuICAgICAgbWVyZ2VNYXAoKG1vdXNlZG93bk9mZnNldFg6IG51bWJlcikgPT4gbW91c2Vtb3ZlJC5waXBlKFxyXG4gICAgICAgIHRha2VVbnRpbChtb3VzZXVwJC5waXBlKHRhcCgoKSA9PiB0aGlzLmRvY3VtZW50Lm9uc2VsZWN0c3RhcnQgPSBudWxsKSkpLFxyXG4gICAgICAgIG1hcCgobW91c2Vtb3ZlRXZlbnQ6IGFueSkgPT4gbW91c2Vtb3ZlRXZlbnQuY2xpZW50WCksXHJcbiAgICAgICAgdGFwKChtb3VzZW1vdmVDbGllbnRYOiBudW1iZXIpID0+IHtcclxuICAgICAgICAgIGNvbnN0IG9mZnNldCA9IG1vdXNlbW92ZUNsaWVudFggLSB0aGlzLmJhclguZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkubGVmdDtcclxuICAgICAgICAgIGNvbnN0IHNjcm9sbCA9IHRoaXMuX3Njcm9sbExlZnRNYXggKiAob2Zmc2V0IC0gbW91c2Vkb3duT2Zmc2V0WCkgLyB0aGlzLl90cmFja0xlZnRNYXg7XHJcbiAgICAgICAgICB0aGlzLnJlbmRlcmVyLnNldFByb3BlcnR5KHRoaXMudmlldywgJ3Njcm9sbExlZnQnLCBzY3JvbGwpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICkpXHJcbiAgICApLnN1YnNjcmliZSgpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogU3RhcnQgdmVydGljYWwgdGh1bWIgd29ya2VyXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBzdGFydFRodW1iWVdvcmtlcigpOiBTdWJzY3JpcHRpb24ge1xyXG4gICAgY29uc3QgbW91c2Vkb3duJCA9IGZyb21FdmVudCh0aGlzLnRodW1iWSwgJ21vdXNlZG93bicpO1xyXG4gICAgY29uc3QgbW91c2V1cCQgPSBmcm9tRXZlbnQodGhpcy5kb2N1bWVudCwgJ21vdXNldXAnKTtcclxuICAgIGNvbnN0IG1vdXNlbW92ZSQgPSBmcm9tRXZlbnQodGhpcy5kb2N1bWVudCwgJ21vdXNlbW92ZScpO1xyXG4gICAgcmV0dXJuIG1vdXNlZG93biQucGlwZShcclxuICAgICAgdGFwKCgpID0+IHRoaXMuZG9jdW1lbnQub25zZWxlY3RzdGFydCA9ICgpID0+IGZhbHNlKSxcclxuICAgICAgbWFwKChtb3VzZWRvd25FdmVudDogYW55KSA9PiBtb3VzZWRvd25FdmVudC5vZmZzZXRZKSxcclxuICAgICAgbWVyZ2VNYXAoKG1vdXNlZG93bk9mZnNldFk6IG51bWJlcikgPT4gbW91c2Vtb3ZlJC5waXBlKFxyXG4gICAgICAgIHRha2VVbnRpbChtb3VzZXVwJC5waXBlKHRhcCgoKSA9PiB0aGlzLmRvY3VtZW50Lm9uc2VsZWN0c3RhcnQgPSBudWxsKSkpLFxyXG4gICAgICAgIG1hcCgobW91c2Vtb3ZlRXZlbnQ6IGFueSkgPT4gbW91c2Vtb3ZlRXZlbnQuY2xpZW50WSksXHJcbiAgICAgICAgdGFwKChtb3VzZW1vdmVDbGllbnRZOiBudW1iZXIpID0+IHtcclxuICAgICAgICAgIGNvbnN0IG9mZnNldCA9IG1vdXNlbW92ZUNsaWVudFkgLSB0aGlzLmJhclkuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkudG9wO1xyXG4gICAgICAgICAgY29uc3Qgc2Nyb2xsID0gdGhpcy5fc2Nyb2xsVG9wTWF4ICogKG9mZnNldCAtIG1vdXNlZG93bk9mZnNldFkpIC8gdGhpcy5fdHJhY2tUb3BNYXg7XHJcbiAgICAgICAgICB0aGlzLnJlbmRlcmVyLnNldFByb3BlcnR5KHRoaXMudmlldywgJ3Njcm9sbFRvcCcsIHNjcm9sbCk7XHJcbiAgICAgICAgfSlcclxuICAgICAgKSlcclxuICAgICkuc3Vic2NyaWJlKCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBDYWxjdWxhdGUgVGh1bWIgWCBTaXplXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBjYWxjdWxhdGVUaHVtYlhTaXplKCk6IG51bWJlciB7XHJcbiAgICB0aGlzLl9uYXR1cmFsVGh1bWJTaXplWCA9IHRoaXMuYmFyWC5jbGllbnRXaWR0aCAvIHRoaXMudmlldy5zY3JvbGxXaWR0aCAqIHRoaXMuYmFyWC5jbGllbnRXaWR0aDtcclxuICAgIHRoaXMuX3Njcm9sbExlZnRNYXggPSB0aGlzLnZpZXcuc2Nyb2xsV2lkdGggLSB0aGlzLnZpZXcuY2xpZW50V2lkdGg7XHJcbiAgICByZXR1cm4gdGhpcy5zY3JvbGxCb3VuZGFyaWVzKHRoaXMuX25hdHVyYWxUaHVtYlNpemVYLCB0aGlzLl9zY3JvbGxMZWZ0TWF4KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENhbGN1bGF0ZSBUaHVtYiBZIFNpemVcclxuICAgKi9cclxuICBwcml2YXRlIGNhbGN1bGF0ZVRodW1iWVNpemUoKTogbnVtYmVyIHtcclxuICAgIHRoaXMuX25hdHVyYWxUaHVtYlNpemVZID0gdGhpcy5iYXJZLmNsaWVudEhlaWdodCAvIHRoaXMudmlldy5zY3JvbGxIZWlnaHQgKiB0aGlzLmJhclkuY2xpZW50SGVpZ2h0O1xyXG4gICAgdGhpcy5fc2Nyb2xsVG9wTWF4ID0gdGhpcy52aWV3LnNjcm9sbEhlaWdodCAtIHRoaXMudmlldy5jbGllbnRIZWlnaHQ7XHJcbiAgICByZXR1cm4gdGhpcy5zY3JvbGxCb3VuZGFyaWVzKHRoaXMuX25hdHVyYWxUaHVtYlNpemVZLCB0aGlzLl9zY3JvbGxUb3BNYXgpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IHNjcm9sbGJhciB0aHVtYiBzaXplXHJcbiAgICogQHBhcmFtIG5hdHVyYWxUaHVtYlNpemVcclxuICAgKiBAcGFyYW0gc2Nyb2xsTWF4XHJcbiAgICovXHJcbiAgcHJpdmF0ZSBzY3JvbGxCb3VuZGFyaWVzKG5hdHVyYWxUaHVtYlNpemU6IG51bWJlciwgc2Nyb2xsTWF4OiBudW1iZXIpOiBudW1iZXIge1xyXG4gICAgcmV0dXJuIChuYXR1cmFsVGh1bWJTaXplIDwgdGhpcy5fbWluVGh1bWJTaXplKSA/IHRoaXMuX21pblRodW1iU2l6ZSA6IHNjcm9sbE1heCA/IG5hdHVyYWxUaHVtYlNpemUgOiAwO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogU2V0IGhvcml6b250YWwgc2Nyb2xsYmFyIHRodW1iIHN0eWxlXHJcbiAgICogQHBhcmFtIHhcclxuICAgKiBAcGFyYW0gd2lkdGhcclxuICAgKi9cclxuICBwcml2YXRlIHNldFRodW1iWFBvc2l0aW9uKHg6IG51bWJlciwgd2lkdGg6IG51bWJlcikge1xyXG4gICAgY29uc3QgdHJhbnNmb3JtID0gYHRyYW5zbGF0ZTNkKCR7eH1weCwgMCwgMClgO1xyXG4gICAgdGhpcy5yZW5kZXJlci5zZXRTdHlsZSh0aGlzLnRodW1iWCwgJ3RyYW5zZm9ybScsIHRyYW5zZm9ybSk7XHJcbiAgICB0aGlzLnJlbmRlcmVyLnNldFN0eWxlKHRoaXMudGh1bWJYLCAnd2lkdGgnLCB3aWR0aCArICdweCcpO1xyXG4gICAgdGhpcy5fY3VyclhQb3MgPSB4O1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogU2V0IHZlcnRpY2FsIHNjcm9sbGJhciB0aHVtYiBzdHlsZVxyXG4gICAqIEBwYXJhbSB5XHJcbiAgICogQHBhcmFtIGhlaWdodFxyXG4gICAqL1xyXG4gIHByaXZhdGUgc2V0VGh1bWJZUG9zaXRpb24oeTogbnVtYmVyLCBoZWlnaHQ6IG51bWJlcikge1xyXG4gICAgY29uc3QgdHJhbnNmb3JtID0gYHRyYW5zbGF0ZTNkKDAsICR7eX1weCwgMClgO1xyXG4gICAgdGhpcy5yZW5kZXJlci5zZXRTdHlsZSh0aGlzLnRodW1iWSwgJ3RyYW5zZm9ybScsIHRyYW5zZm9ybSk7XHJcbiAgICB0aGlzLnJlbmRlcmVyLnNldFN0eWxlKHRoaXMudGh1bWJZLCAnaGVpZ2h0JywgaGVpZ2h0ICsgJ3B4Jyk7XHJcbiAgICB0aGlzLl9jdXJyWVBvcyA9IHk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBIaWRlIG5hdGl2ZSBzY3JvbGxiYXJzXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBoaWRlTmF0aXZlU2Nyb2xsYmFycygpIHtcclxuICAgIGNvbnN0IHNpemUgPSBgY2FsYygxMDAlICsgJHt0aGlzLmdldE5hdGl2ZVNjcm9sbGJhcldpZHRoKCl9cHgpYDtcclxuICAgIHRoaXMucmVuZGVyZXIuc2V0U3R5bGUodGhpcy52aWV3LCAnd2lkdGgnLCBzaXplKTtcclxuICAgIHRoaXMucmVuZGVyZXIuc2V0U3R5bGUodGhpcy52aWV3LCAnaGVpZ2h0Jywgc2l6ZSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZXQgdGhlIG5hdGl2ZSBzY3JvbGxiYXIgd2lkdGhcclxuICAgKi9cclxuICBwcml2YXRlIGdldE5hdGl2ZVNjcm9sbGJhcldpZHRoKCk6IG51bWJlciB7XHJcbiAgICBjb25zdCBlbGVtZW50ID0gdGhpcy5kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgIGVsZW1lbnQuc3R5bGUucG9zaXRpb24gPSAnYWJzb2x1dGUnO1xyXG4gICAgZWxlbWVudC5zdHlsZS50b3AgPSAnLTk5OTlweCc7XHJcbiAgICBlbGVtZW50LnN0eWxlLndpZHRoID0gJzEwMHB4JztcclxuICAgIGVsZW1lbnQuc3R5bGUuaGVpZ2h0ID0gJzEwMHB4JztcclxuICAgIGVsZW1lbnQuc3R5bGUub3ZlcmZsb3cgPSAnc2Nyb2xsJztcclxuICAgIGVsZW1lbnQuc3R5bGUubXNPdmVyZmxvd1N0eWxlID0gJ3Njcm9sbGJhcic7XHJcbiAgICB0aGlzLmRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoZWxlbWVudCk7XHJcbiAgICBjb25zdCBzdyA9IGVsZW1lbnQub2Zmc2V0V2lkdGggLSBlbGVtZW50LmNsaWVudFdpZHRoO1xyXG4gICAgdGhpcy5kb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKGVsZW1lbnQpO1xyXG4gICAgcmV0dXJuIHN3O1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgeyBDb21tb25Nb2R1bGUgfSBmcm9tICdAYW5ndWxhci9jb21tb24nO1xyXG5pbXBvcnQgeyBOZ01vZHVsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBPYnNlcnZlcnNNb2R1bGUgfSBmcm9tICdAYW5ndWxhci9jZGsvb2JzZXJ2ZXJzJztcclxuaW1wb3J0IHsgU2Nyb2xsYmFyQ29tcG9uZW50IH0gZnJvbSAnLi9zY3JvbGxiYXIuY29tcG9uZW50JztcclxuXHJcbkBOZ01vZHVsZSh7XHJcbiAgaW1wb3J0czogW1xyXG4gICAgQ29tbW9uTW9kdWxlLFxyXG4gICAgT2JzZXJ2ZXJzTW9kdWxlXHJcbiAgXSxcclxuICBkZWNsYXJhdGlvbnM6IFtTY3JvbGxiYXJDb21wb25lbnRdLFxyXG4gIGV4cG9ydHM6IFtTY3JvbGxiYXJDb21wb25lbnRdXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBTY3JvbGxiYXJNb2R1bGUge1xyXG59XHJcbiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQUE7SUFrRkUsNEJBQW9CLElBQVksRUFBVSxRQUFtQixFQUE0QjtRQUFyRSxTQUFJLEdBQUosSUFBSSxDQUFRO1FBQVUsYUFBUSxHQUFSLFFBQVEsQ0FBVztRQUE0QixhQUFRLEdBQVIsUUFBUTsyQkF0QzNFLENBQUM7MkJBQ0QsQ0FBQzs0QkFDQSxDQUFDOzZCQUNBLENBQUM7OEJBQ0EsQ0FBQzs2QkFDRixDQUFDO2tDQUNJLENBQUM7a0NBQ0QsQ0FBQzt5QkFDVixDQUFDO3lCQUNELENBQUM7NkJBQ0csRUFBRTswQkFtQkosSUFBSTt3QkFDTixLQUFLO3NCQUNQLEtBQUs7c0JBQ0wsSUFBSTsyQkFJRSxJQUFJLFlBQVksRUFBTztLQUc5Qzs7OztJQUVELDRDQUFlOzs7SUFBZjtRQUFBLGlCQXdCQztRQXRCQyxJQUFJLENBQUMsSUFBSSxDQUFDLGlCQUFpQixDQUFDO1lBQzFCLEtBQUksQ0FBQyxJQUFJLEdBQUcsS0FBSSxDQUFDLE9BQU8sQ0FBQyxhQUFhLENBQUM7WUFDdkMsS0FBSSxDQUFDLElBQUksR0FBRyxLQUFJLENBQUMsT0FBTyxDQUFDLGFBQWEsQ0FBQztZQUN2QyxLQUFJLENBQUMsTUFBTSxHQUFH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