import { Component, Inject, Input, Output, ViewChild, ChangeDetectionStrategy, EventEmitter, Renderer2, ViewEncapsulation, NgZone, NgModule } from '@angular/core';
import { DOCUMENT, CommonModule } from '@angular/common';
import { fromEvent, of, EMPTY } from 'rxjs';
import { delay, expand, map, mergeMap, takeUntil, takeWhile, tap } from 'rxjs/operators';
import { ObserversModule } from '@angular/cdk/observers';

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */
class ScrollbarComponent {
    /**
     * @param {?} zone
     * @param {?} renderer
     * @param {?} document
     */
    constructor(zone, renderer, document) {
        this.zone = zone;
        this.renderer = renderer;
        this.document = document;
        this._thumbSizeY = 0;
        this._thumbSizeX = 0;
        this._trackTopMax = 0;
        this._trackLeftMax = 0;
        this._scrollLeftMax = 0;
        this._scrollTopMax = 0;
        this._naturalThumbSizeY = 0;
        this._naturalThumbSizeX = 0;
        this._currXPos = 0;
        this._currYPos = 0;
        this._minThumbSize = 20;
        this.autoUpdate = true;
        this.autoHide = false;
        this.trackX = false;
        this.trackY = true;
        this.scrollState = new EventEmitter();
    }
    /**
     * @return {?}
     */
    ngAfterViewInit() {
        this.zone.runOutsideAngular(() => {
            this.barX = this.barXRef.nativeElement;
            this.barY = this.barYRef.nativeElement;
            this.thumbX = this.thumbXRef.nativeElement;
            this.thumbY = this.thumbYRef.nativeElement;
            this.view = this.viewRef.nativeElement;
            this.hideNativeScrollbars();
            /** Initialize scrollbars */
            this.scrollWorker(null);
            this._scrollSub$ = fromEvent(this.view, 'scroll').pipe(tap((e) => this.scrollWorker(e))).subscribe();
            if (this.trackX) {
                this._barXSub$ = fromEvent(this.barX, 'mousedown').pipe(tap((e) => this.barXWorker(e))).subscribe();
                this._thumbXSub$ = this.startThumbXWorker();
            }
            if (this.trackY) {
                this._barYSub$ = fromEvent(this.barY, 'mousedown').pipe(tap((e) => this.barYWorker(e))).subscribe();
                this._thumbYSub$ = this.startThumbYWorker();
            }
        });
    }
    /**
     * @return {?}
     */
    ngOnDestroy() {
        if (this._scrollSub$) {
            this._scrollSub$.unsubscribe();
        }
        if (this.trackX) {
            this._barXSub$.unsubscribe();
            this._thumbXSub$.unsubscribe();
        }
        if (this.trackY) {
            this._barYSub$.unsubscribe();
            this._thumbYSub$.unsubscribe();
        }
    }
    /**
     * Scroll horizontally
     * @param {?} to
     * @param {?=} duration
     * @return {?}
     */
    scrollXTo(to, duration) {
        if (duration) {
            of(duration).pipe(takeWhile(() => duration > 0), expand((d) => {
                if (d > 0) {
                    const /** @type {?} */ difference = to - this.view.scrollLeft;
                    const /** @type {?} */ perTick = difference / d * 10;
                    this.renderer.setProperty(this.view, 'scrollLeft', this.view.scrollLeft + perTick);
                    return of(d - 10).pipe(delay(10));
                }
                else {
                    duration = d;
                    return EMPTY;
                }
            })).subscribe();
        }
        else {
            this.renderer.setProperty(this.view, 'scrollLeft', to);
        }
    }
    /**
     * Scroll vertically
     * @param {?} to
     * @param {?=} duration
     * @return {?}
     */
    scrollYTo(to, duration) {
        if (duration) {
            of(duration).pipe(takeWhile(() => duration > 0), expand((d) => {
                if (d > 0) {
                    const /** @type {?} */ difference = to - this.view.scrollTop;
                    const /** @type {?} */ perTick = difference / d * 10;
                    this.renderer.setProperty(this.view, 'scrollTop', this.view.scrollTop + perTick);
                    return of(d - 10).pipe(delay(10));
                }
                else {
                    duration = d;
                    return EMPTY;
                }
            })).subscribe();
        }
        else {
            this.renderer.setProperty(this.view, 'scrollTop', to);
        }
    }
    /**
     * Scroll view to top
     * @param {?=} duration
     * @return {?}
     */
    scrollToTop(duration) {
        this.scrollYTo(0, duration);
    }
    /**
     * Scroll view to bottom
     * @param {?=} duration
     * @return {?}
     */
    scrollToBottom(duration) {
        this.scrollYTo(this.view.scrollHeight, duration);
    }
    /**
     * Scroll view to max right
     * @param {?=} duration
     * @return {?}
     */
    scrollToRight(duration) {
        this.scrollXTo(this.view.scrollWidth, duration);
    }
    /**
     * Scroll view to max left
     * @param {?=} duration
     * @return {?}
     */
    scrollToLeft(duration) {
        this.scrollXTo(0, duration);
    }
    /**
     * Update thumbnails
     * @return {?}
     */
    update() {
        this.setThumbXPosition(this._currXPos, this.calculateThumbXSize());
        this.setThumbYPosition(this._currYPos, this.calculateThumbYSize());
    }
    /**
     * Scroll Worker
     * @param {?} e - Mouse Event
     * @return {?}
     */
    scrollWorker(e) {
        this._thumbSizeX = this.thumbX.clientWidth;
        this._thumbSizeY = this.thumbY.clientHeight;
        this._trackLeftMax = this.barX.clientWidth - this._thumbSizeX;
        this._trackTopMax = this.barY.clientHeight - this._thumbSizeY;
        const /** @type {?} */ thumbXPosition = this.view.scrollLeft * this._trackLeftMax / this._scrollLeftMax;
        const /** @type {?} */ thumbYPosition = this.view.scrollTop * this._trackTopMax / this._scrollTopMax;
        this.setThumbXPosition(thumbXPosition, this.calculateThumbXSize());
        this.setThumbYPosition(thumbYPosition, this.calculateThumbYSize());
        /** Emit scroll state */
        this.scrollState.emit(e);
    }
    /**
     * Horizontal scrollbar click worker
     * @param {?} e - Mouse Event
     * @return {?}
     */
    barXWorker(e) {
        if (e.target === e.currentTarget) {
            const /** @type {?} */ offset = e.offsetX - this._naturalThumbSizeX * .5;
            const /** @type {?} */ thumbPositionPercentage = offset * 100 / this.barX.clientWidth;
            const /** @type {?} */ scrollLeft = thumbPositionPercentage * this.view.scrollWidth / 100;
            this.renderer.setProperty(this.view, 'scrollLeft', scrollLeft);
        }
    }
    /**
     * Vertical scrollbar click worker
     * @param {?} e - Mouse Event
     * @return {?}
     */
    barYWorker(e) {
        if (e.target === e.currentTarget) {
            const /** @type {?} */ offset = e.offsetY - this._naturalThumbSizeY * .5;
            const /** @type {?} */ thumbPositionPercentage = offset * 100 / this.barY.clientHeight;
            const /** @type {?} */ scrollTop = thumbPositionPercentage * this.view.scrollHeight / 100;
            this.renderer.setProperty(this.view, 'scrollTop', scrollTop);
        }
    }
    /**
     * Start horizontal thumb worker
     * @return {?}
     */
    startThumbXWorker() {
        const /** @type {?} */ mousedown$ = fromEvent(this.thumbX, 'mousedown');
        const /** @type {?} */ mouseup$ = fromEvent(this.document, 'mouseup');
        const /** @type {?} */ mousemove$ = fromEvent(this.document, 'mousemove');
        return mousedown$.pipe(tap(() => this.document.onselectstart = () => false), map((mousedownEvent) => mousedownEvent.offsetX), mergeMap((mousedownOffsetX) => mousemove$.pipe(takeUntil(mouseup$.pipe(tap(() => this.document.onselectstart = null))), map((mousemoveEvent) => mousemoveEvent.clientX), tap((mousemoveClientX) => {
            const /** @type {?} */ offset = mousemoveClientX - this.barX.getBoundingClientRect().left;
            const /** @type {?} */ scroll = this._scrollLeftMax * (offset - mousedownOffsetX) / this._trackLeftMax;
            this.renderer.setProperty(this.view, 'scrollLeft', scroll);
        })))).subscribe();
    }
    /**
     * Start vertical thumb worker
     * @return {?}
     */
    startThumbYWorker() {
        const /** @type {?} */ mousedown$ = fromEvent(this.thumbY, 'mousedown');
        const /** @type {?} */ mouseup$ = fromEvent(this.document, 'mouseup');
        const /** @type {?} */ mousemove$ = fromEvent(this.document, 'mousemove');
        return mousedown$.pipe(tap(() => this.document.onselectstart = () => false), map((mousedownEvent) => mousedownEvent.offsetY), mergeMap((mousedownOffsetY) => mousemove$.pipe(takeUntil(mouseup$.pipe(tap(() => this.document.onselectstart = null))), map((mousemoveEvent) => mousemoveEvent.clientY), tap((mousemoveClientY) => {
            const /** @type {?} */ offset = mousemoveClientY - this.barY.getBoundingClientRect().top;
            const /** @type {?} */ scroll = this._scrollTopMax * (offset - mousedownOffsetY) / this._trackTopMax;
            this.renderer.setProperty(this.view, 'scrollTop', scroll);
        })))).subscribe();
    }
    /**
     * Calculate Thumb X Size
     * @return {?}
     */
    calculateThumbXSize() {
        this._naturalThumbSizeX = this.barX.clientWidth / this.view.scrollWidth * this.barX.clientWidth;
        this._scrollLeftMax = this.view.scrollWidth - this.view.clientWidth;
        return this.scrollBoundaries(this._naturalThumbSizeX, this._scrollLeftMax);
    }
    /**
     * Calculate Thumb Y Size
     * @return {?}
     */
    calculateThumbYSize() {
        this._naturalThumbSizeY = this.barY.clientHeight / this.view.scrollHeight * this.barY.clientHeight;
        this._scrollTopMax = this.view.scrollHeight - this.view.clientHeight;
        return this.scrollBoundaries(this._naturalThumbSizeY, this._scrollTopMax);
    }
    /**
     * Get scrollbar thumb size
     * @param {?} naturalThumbSize
     * @param {?} scrollMax
     * @return {?}
     */
    scrollBoundaries(naturalThumbSize, scrollMax) {
        return (naturalThumbSize < this._minThumbSize) ? this._minThumbSize : scrollMax ? naturalThumbSize : 0;
    }
    /**
     * Set horizontal scrollbar thumb style
     * @param {?} x
     * @param {?} width
     * @return {?}
     */
    setThumbXPosition(x, width) {
        const /** @type {?} */ transform = `translate3d(${x}px, 0, 0)`;
        this.renderer.setStyle(this.thumbX, 'transform', transform);
        this.renderer.setStyle(this.thumbX, 'width', width + 'px');
        this._currXPos = x;
    }
    /**
     * Set vertical scrollbar thumb style
     * @param {?} y
     * @param {?} height
     * @return {?}
     */
    setThumbYPosition(y, height) {
        const /** @type {?} */ transform = `translate3d(0, ${y}px, 0)`;
        this.renderer.setStyle(this.thumbY, 'transform', transform);
        this.renderer.setStyle(this.thumbY, 'height', height + 'px');
        this._currYPos = y;
    }
    /**
     * Hide native scrollbars
     * @return {?}
     */
    hideNativeScrollbars() {
        const /** @type {?} */ size = `calc(100% + ${this.getNativeScrollbarWidth()}px)`;
        this.renderer.setStyle(this.view, 'width', size);
        this.renderer.setStyle(this.view, 'height', size);
    }
    /**
     * Get the native scrollbar width
     * @return {?}
     */
    getNativeScrollbarWidth() {
        const /** @type {?} */ element = this.document.createElement('div');
        element.style.position = 'absolute';
        element.style.top = '-9999px';
        element.style.width = '100px';
        element.style.height = '100px';
        element.style.overflow = 'scroll';
        element.style.msOverflowStyle = 'scrollbar';
        this.document.body.appendChild(element);
        const /** @type {?} */ sw = element.offsetWidth - element.clientWidth;
        this.document.body.removeChild(element);
        return sw;
    }
}
ScrollbarComponent.decorators = [
    { type: Component, args: [{
                selector: 'ng-scrollbar',
                template: `<div class="ng-scrollbar-container" [class.ng-scrollbar-autohide]="autoHide">

  <div #barX class="ng-scrollbar -horizontal {{barClass}}" [class.ng-scrollbar-disabled]="!trackX">
    <div #thumbX class="ng-scrollbar-thumb {{thumbClass}}"></div>
  </div>

  <div #barY class="ng-scrollbar -vertical {{barClass}}" [class.ng-scrollbar-disabled]="!trackY">
    <div #thumbY class="ng-scrollbar-thumb {{thumbClass}}"></div>
  </div>

  <div #view class="ng-scrollbar-view {{viewClass}}"
       (cdkObserveContent)="update()"
       [cdkObserveContentDisabled]="autoUpdate">
    <ng-content></ng-content>
  </div>
</div>
`,
                styles: [`ng-scrollbar{display:block;position:relative;height:100%;overflow:hidden!important}.ng-scrollbar-container{position:relative;overflow:hidden!important;width:100%;height:100%}.ng-scrollbar-autohide>.ng-scrollbar{opacity:0;transition:opacity 120ms ease-out}.ng-scrollbar-autohide:active>.ng-scrollbar,.ng-scrollbar-autohide:focus>.ng-scrollbar,.ng-scrollbar-autohide:hover>.ng-scrollbar{opacity:1;transition:opacity 340ms ease-out}.ng-scrollbar{position:absolute;right:2px;bottom:2px;z-index:1;border-radius:3px}.-vertical{width:6px;top:2px}.-vertical .ng-scrollbar-thumb{width:100%}.-horizontal{height:6px;left:2px}.-horizontal .ng-scrollbar-thumb{height:100%}.ng-scrollbar-disabled{display:none}.ng-scrollbar-thumb{position:relative;display:block;width:0;height:0;border-radius:inherit;background-color:rgba(0,0,0,.2);-webkit-transform:translate3d(0,0,0);transform:translate3d(0,0,0)}.ng-scrollbar-thumb:active,.ng-scrollbar-thumb:hover{background-color:rgba(0,0,0,.3)}.ng-scrollbar-view{width:100%;height:100%;overflow:scroll;-webkit-transform:translate3d(0,0,0);transform:translate3d(0,0,0);-webkit-overflow-scrolling:touch}`],
                changeDetection: ChangeDetectionStrategy.OnPush,
                encapsulation: ViewEncapsulation.None,
                preserveWhitespaces: false
            },] },
];
/** @nocollapse */
ScrollbarComponent.ctorParameters = () => [
    { type: NgZone, },
    { type: Renderer2, },
    { type: undefined, decorators: [{ type: Inject, args: [DOCUMENT,] },] },
];
ScrollbarComponent.propDecorators = {
    "barXRef": [{ type: ViewChild, args: ['barX',] },],
    "barYRef": [{ type: ViewChild, args: ['barY',] },],
    "thumbXRef": [{ type: ViewChild, args: ['thumbX',] },],
    "thumbYRef": [{ type: ViewChild, args: ['thumbY',] },],
    "viewRef": [{ type: ViewChild, args: ['view',] },],
    "autoUpdate": [{ type: Input },],
    "autoHide": [{ type: Input },],
    "trackX": [{ type: Input },],
    "trackY": [{ type: Input },],
    "viewClass": [{ type: Input },],
    "barClass": [{ type: Input },],
    "thumbClass": [{ type: Input },],
    "scrollState": [{ type: Output },],
};

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */
class ScrollbarModule {
}
ScrollbarModule.decorators = [
    { type: NgModule, args: [{
                imports: [
                    CommonModule,
                    ObserversModule
                ],
                declarations: [ScrollbarComponent],
                exports: [ScrollbarComponent]
            },] },
];

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */

export { ScrollbarModule, ScrollbarComponent };

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmd4LXNjcm9sbGJhci5qcy5tYXAiLCJzb3VyY2VzIjpbIm5nOi8vbmd4LXNjcm9sbGJhci9saWIvc2Nyb2xsYmFyLmNvbXBvbmVudC50cyIsIm5nOi8vbmd4LXNjcm9sbGJhci9saWIvc2Nyb2xsYmFyLm1vZHVsZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xyXG4gIENvbXBvbmVudCxcclxuICBJbmplY3QsXHJcbiAgQWZ0ZXJWaWV3SW5pdCxcclxuICBPbkRlc3Ryb3ksXHJcbiAgSW5wdXQsXHJcbiAgT3V0cHV0LFxyXG4gIFZpZXdDaGlsZCxcclxuICBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneSxcclxuICBFdmVudEVtaXR0ZXIsXHJcbiAgUmVuZGVyZXIyLFxyXG4gIFZpZXdFbmNhcHN1bGF0aW9uLFxyXG4gIE5nWm9uZVxyXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBET0NVTUVOVCB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbic7XHJcbmltcG9ydCB7IFN1YnNjcmlwdGlvbiwgZnJvbUV2ZW50LCBvZiwgRU1QVFkgfSBmcm9tICdyeGpzJztcclxuaW1wb3J0IHsgZGVsYXksIGV4cGFuZCwgbWFwLCBtZXJnZU1hcCwgdGFrZVVudGlsLCB0YWtlV2hpbGUsIHRhcCB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcclxuXHJcbkBDb21wb25lbnQoe1xyXG4gIHNlbGVjdG9yOiAnbmctc2Nyb2xsYmFyJyxcclxuICB0ZW1wbGF0ZTogYDxkaXYgY2xhc3M9XCJuZy1zY3JvbGxiYXItY29udGFpbmVyXCIgW2NsYXNzLm5nLXNjcm9sbGJhci1hdXRvaGlkZV09XCJhdXRvSGlkZVwiPlxyXG5cclxuICA8ZGl2ICNiYXJYIGNsYXNzPVwibmctc2Nyb2xsYmFyIC1ob3Jpem9udGFsIHt7YmFyQ2xhc3N9fVwiIFtjbGFzcy5uZy1zY3JvbGxiYXItZGlzYWJsZWRdPVwiIXRyYWNrWFwiPlxyXG4gICAgPGRpdiAjdGh1bWJYIGNsYXNzPVwibmctc2Nyb2xsYmFyLXRodW1iIHt7dGh1bWJDbGFzc319XCI+PC9kaXY+XHJcbiAgPC9kaXY+XHJcblxyXG4gIDxkaXYgI2JhclkgY2xhc3M9XCJuZy1zY3JvbGxiYXIgLXZlcnRpY2FsIHt7YmFyQ2xhc3N9fVwiIFtjbGFzcy5uZy1zY3JvbGxiYXItZGlzYWJsZWRdPVwiIXRyYWNrWVwiPlxyXG4gICAgPGRpdiAjdGh1bWJZIGNsYXNzPVwibmctc2Nyb2xsYmFyLXRodW1iIHt7dGh1bWJDbGFzc319XCI+PC9kaXY+XHJcbiAgPC9kaXY+XHJcblxyXG4gIDxkaXYgI3ZpZXcgY2xhc3M9XCJuZy1zY3JvbGxiYXItdmlldyB7e3ZpZXdDbGFzc319XCJcclxuICAgICAgIChjZGtPYnNlcnZlQ29udGVudCk9XCJ1cGRhdGUoKVwiXHJcbiAgICAgICBbY2RrT2JzZXJ2ZUNvbnRlbnREaXNhYmxlZF09XCJhdXRvVXBkYXRlXCI+XHJcbiAgICA8bmctY29udGVudD48L25nLWNvbnRlbnQ+XHJcbiAgPC9kaXY+XHJcbjwvZGl2PlxyXG5gLFxyXG4gIHN0eWxlczogW2BuZy1zY3JvbGxiYXJ7ZGlzcGxheTpibG9jaztwb3NpdGlvbjpyZWxhdGl2ZTtoZWlnaHQ6MTAwJTtvdmVyZmxvdzpoaWRkZW4haW1wb3J0YW50fS5uZy1zY3JvbGxiYXItY29udGFpbmVye3Bvc2l0aW9uOnJlbGF0aXZlO292ZXJmbG93OmhpZGRlbiFpbXBvcnRhbnQ7d2lkdGg6MTAwJTtoZWlnaHQ6MTAwJX0ubmctc2Nyb2xsYmFyLWF1dG9oaWRlPi5uZy1zY3JvbGxiYXJ7b3BhY2l0eTowO3RyYW5zaXRpb246b3BhY2l0eSAxMjBtcyBlYXNlLW91dH0ubmctc2Nyb2xsYmFyLWF1dG9oaWRlOmFjdGl2ZT4ubmctc2Nyb2xsYmFyLC5uZy1zY3JvbGxiYXItYXV0b2hpZGU6Zm9jdXM+Lm5nLXNjcm9sbGJhciwubmctc2Nyb2xsYmFyLWF1dG9oaWRlOmhvdmVyPi5uZy1zY3JvbGxiYXJ7b3BhY2l0eToxO3RyYW5zaXRpb246b3BhY2l0eSAzNDBtcyBlYXNlLW91dH0ubmctc2Nyb2xsYmFye3Bvc2l0aW9uOmFic29sdXRlO3JpZ2h0OjJweDtib3R0b206MnB4O3otaW5kZXg6MTtib3JkZXItcmFkaXVzOjNweH0uLXZlcnRpY2Fse3dpZHRoOjZweDt0b3A6MnB4fS4tdmVydGljYWwgLm5nLXNjcm9sbGJhci10aHVtYnt3aWR0aDoxMDAlfS4taG9yaXpvbnRhbHtoZWlnaHQ6NnB4O2xlZnQ6MnB4fS4taG9yaXpvbnRhbCAubmctc2Nyb2xsYmFyLXRodW1ie2hlaWdodDoxMDAlfS5uZy1zY3JvbGxiYXItZGlzYWJsZWR7ZGlzcGxheTpub25lfS5uZy1zY3JvbGxiYXItdGh1bWJ7cG9zaXRpb246cmVsYXRpdmU7ZGlzcGxheTpibG9jazt3aWR0aDowO2hlaWdodDowO2JvcmRlci1yYWRpdXM6aW5oZXJpdDtiYWNrZ3JvdW5kLWNvbG9yOnJnYmEoMCwwLDAsLjIpOy13ZWJraXQtdHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMCwwKTt0cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApfS5uZy1zY3JvbGxiYXItdGh1bWI6YWN0aXZlLC5uZy1zY3JvbGxiYXItdGh1bWI6aG92ZXJ7YmFja2dyb3VuZC1jb2xvcjpyZ2JhKDAsMCwwLC4zKX0ubmctc2Nyb2xsYmFyLXZpZXd7d2lkdGg6MTAwJTtoZWlnaHQ6MTAwJTtvdmVyZmxvdzpzY3JvbGw7LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApO3RyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCk7LXdlYmtpdC1vdmVyZmxvdy1zY3JvbGxpbmc6dG91Y2h9YF0sXHJcbiAgY2hhbmdlRGV0ZWN0aW9uOiBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneS5PblB1c2gsXHJcbiAgZW5jYXBzdWxhdGlvbjogVmlld0VuY2Fwc3VsYXRpb24uTm9uZSxcclxuICBwcmVzZXJ2ZVdoaXRlc3BhY2VzOiBmYWxzZVxyXG59KVxyXG5leHBvcnQgY2xhc3MgU2Nyb2xsYmFyQ29tcG9uZW50IGltcGxlbWVudHMgQWZ0ZXJWaWV3SW5pdCwgT25EZXN0cm95IHtcclxuXHJcbiAgcHJpdmF0ZSBfdGh1bWJTaXplWSA9IDA7XHJcbiAgcHJpdmF0ZSBfdGh1bWJTaXplWCA9IDA7XHJcbiAgcHJpdmF0ZSBfdHJhY2tUb3BNYXggPSAwO1xyXG4gIHByaXZhdGUgX3RyYWNrTGVmdE1heCA9IDA7XHJcbiAgcHJpdmF0ZSBfc2Nyb2xsTGVmdE1heCA9IDA7XHJcbiAgcHJpdmF0ZSBfc2Nyb2xsVG9wTWF4ID0gMDtcclxuICBwcml2YXRlIF9uYXR1cmFsVGh1bWJTaXplWSA9IDA7XHJcbiAgcHJpdmF0ZSBfbmF0dXJhbFRodW1iU2l6ZVggPSAwO1xyXG4gIHByaXZhdGUgX2N1cnJYUG9zID0gMDtcclxuICBwcml2YXRlIF9jdXJyWVBvcyA9IDA7XHJcbiAgcHJpdmF0ZSBfbWluVGh1bWJTaXplID0gMjA7XHJcbiAgcHJpdmF0ZSBfc2Nyb2xsU3ViJDogU3Vic2NyaXB0aW9uO1xyXG4gIHByaXZhdGUgX2JhclhTdWIkOiBTdWJzY3JpcHRpb247XHJcbiAgcHJpdmF0ZSBfYmFyWVN1YiQ6IFN1YnNjcmlwdGlvbjtcclxuICBwcml2YXRlIF90aHVtYlhTdWIkOiBTdWJzY3JpcHRpb247XHJcbiAgcHJpdmF0ZSBfdGh1bWJZU3ViJDogU3Vic2NyaXB0aW9uO1xyXG5cclxuICBiYXJYOiBIVE1MRWxlbWVudDtcclxuICBiYXJZOiBIVE1MRWxlbWVudDtcclxuICB0aHVtYlg6IEhUTUxFbGVtZW50O1xyXG4gIHRodW1iWTogSFRNTEVsZW1lbnQ7XHJcbiAgdmlldzogSFRNTEVsZW1lbnQ7XHJcblxyXG4gIEBWaWV3Q2hpbGQoJ2JhclgnKSBiYXJYUmVmO1xyXG4gIEBWaWV3Q2hpbGQoJ2JhclknKSBiYXJZUmVmO1xyXG4gIEBWaWV3Q2hpbGQoJ3RodW1iWCcpIHRodW1iWFJlZjtcclxuICBAVmlld0NoaWxkKCd0aHVtYlknKSB0aHVtYllSZWY7XHJcbiAgQFZpZXdDaGlsZCgndmlldycpIHZpZXdSZWY7XHJcblxyXG4gIEBJbnB1dCgpIGF1dG9VcGRhdGUgPSB0cnVlO1xyXG4gIEBJbnB1dCgpIGF1dG9IaWRlID0gZmFsc2U7XHJcbiAgQElucHV0KCkgdHJhY2tYID0gZmFsc2U7XHJcbiAgQElucHV0KCkgdHJhY2tZID0gdHJ1ZTtcclxuICBASW5wdXQoKSB2aWV3Q2xhc3M6IHN0cmluZztcclxuICBASW5wdXQoKSBiYXJDbGFzczogc3RyaW5nO1xyXG4gIEBJbnB1dCgpIHRodW1iQ2xhc3M6IHN0cmluZztcclxuICBAT3V0cHV0KCkgc2Nyb2xsU3RhdGUgPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcclxuXHJcbiAgY29uc3RydWN0b3IocHJpdmF0ZSB6b25lOiBOZ1pvbmUsIHByaXZhdGUgcmVuZGVyZXI6IFJlbmRlcmVyMiwgQEluamVjdChET0NVTUVOVCkgcHJpdmF0ZSBkb2N1bWVudDogYW55KSB7XHJcbiAgfVxyXG5cclxuICBuZ0FmdGVyVmlld0luaXQoKSB7XHJcblxyXG4gICAgdGhpcy56b25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IHtcclxuICAgICAgdGhpcy5iYXJYID0gdGhpcy5iYXJYUmVmLm5hdGl2ZUVsZW1lbnQ7XHJcbiAgICAgIHRoaXMuYmFyWSA9IHRoaXMuYmFyWVJlZi5uYXRpdmVFbGVtZW50O1xyXG4gICAgICB0aGlzLnRodW1iWCA9IHRoaXMudGh1bWJYUmVmLm5hdGl2ZUVsZW1lbnQ7XHJcbiAgICAgIHRoaXMudGh1bWJZID0gdGhpcy50aHVtYllSZWYubmF0aXZlRWxlbWVudDtcclxuICAgICAgdGhpcy52aWV3ID0gdGhpcy52aWV3UmVmLm5hdGl2ZUVsZW1lbnQ7XHJcblxyXG4gICAgICB0aGlzLmhpZGVOYXRpdmVTY3JvbGxiYXJzKCk7XHJcblxyXG4gICAgICAvKiogSW5pdGlhbGl6ZSBzY3JvbGxiYXJzICovXHJcbiAgICAgIHRoaXMuc2Nyb2xsV29ya2VyKG51bGwpO1xyXG5cclxuICAgICAgdGhpcy5fc2Nyb2xsU3ViJCA9IGZyb21FdmVudCh0aGlzLnZpZXcsICdzY3JvbGwnKS5waXBlKHRhcCgoZSkgPT4gdGhpcy5zY3JvbGxXb3JrZXIoZSkpKS5zdWJzY3JpYmUoKTtcclxuICAgICAgaWYgKHRoaXMudHJhY2tYKSB7XHJcbiAgICAgICAgdGhpcy5fYmFyWFN1YiQgPSBmcm9tRXZlbnQodGhpcy5iYXJYLCAnbW91c2Vkb3duJykucGlwZSh0YXAoKGUpID0+IHRoaXMuYmFyWFdvcmtlcihlKSkpLnN1YnNjcmliZSgpO1xyXG4gICAgICAgIHRoaXMuX3RodW1iWFN1YiQgPSB0aGlzLnN0YXJ0VGh1bWJYV29ya2VyKCk7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKHRoaXMudHJhY2tZKSB7XHJcbiAgICAgICAgdGhpcy5fYmFyWVN1YiQgPSBmcm9tRXZlbnQodGhpcy5iYXJZLCAnbW91c2Vkb3duJykucGlwZSh0YXAoKGUpID0+IHRoaXMuYmFyWVdvcmtlcihlKSkpLnN1YnNjcmliZSgpO1xyXG4gICAgICAgIHRoaXMuX3RodW1iWVN1YiQgPSB0aGlzLnN0YXJ0VGh1bWJZV29ya2VyKCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgbmdPbkRlc3Ryb3koKSB7XHJcbiAgICBpZiAodGhpcy5fc2Nyb2xsU3ViJCkge1xyXG4gICAgICB0aGlzLl9zY3JvbGxTdWIkLnVuc3Vic2NyaWJlKCk7XHJcbiAgICB9XHJcbiAgICBpZiAodGhpcy50cmFja1gpIHtcclxuICAgICAgdGhpcy5fYmFyWFN1YiQudW5zdWJzY3JpYmUoKTtcclxuICAgICAgdGhpcy5fdGh1bWJYU3ViJC51bnN1YnNjcmliZSgpO1xyXG4gICAgfVxyXG4gICAgaWYgKHRoaXMudHJhY2tZKSB7XHJcbiAgICAgIHRoaXMuX2JhcllTdWIkLnVuc3Vic2NyaWJlKCk7XHJcbiAgICAgIHRoaXMuX3RodW1iWVN1YiQudW5zdWJzY3JpYmUoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFNjcm9sbCBob3Jpem9udGFsbHlcclxuICAgKiBAcGFyYW0gdG9cclxuICAgKiBAcGFyYW0gZHVyYXRpb25cclxuICAgKi9cclxuICBzY3JvbGxYVG8odG86IG51bWJlciwgZHVyYXRpb24/OiBudW1iZXIpIHtcclxuICAgIGlmIChkdXJhdGlvbikge1xyXG4gICAgICBvZihkdXJhdGlvbikucGlwZShcclxuICAgICAgICB0YWtlV2hpbGUoKCkgPT4gZHVyYXRpb24gPiAwKSxcclxuICAgICAgICBleHBhbmQoKGQ6IG51bWJlcikgPT4ge1xyXG4gICAgICAgICAgaWYgKGQgPiAwKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGRpZmZlcmVuY2UgPSB0byAtIHRoaXMudmlldy5zY3JvbGxMZWZ0O1xyXG4gICAgICAgICAgICBjb25zdCBwZXJUaWNrID0gZGlmZmVyZW5jZSAvIGQgKiAxMDtcclxuICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5zZXRQcm9wZXJ0eSh0aGlzLnZpZXcsICdzY3JvbGxMZWZ0JywgdGhpcy52aWV3LnNjcm9sbExlZnQgKyBwZXJUaWNrKTtcclxuICAgICAgICAgICAgcmV0dXJuIG9mKGQgLSAxMCkucGlwZShkZWxheSgxMCkpO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgZHVyYXRpb24gPSBkO1xyXG4gICAgICAgICAgICByZXR1cm4gRU1QVFk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgICAgKS5zdWJzY3JpYmUoKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMucmVuZGVyZXIuc2V0UHJvcGVydHkodGhpcy52aWV3LCAnc2Nyb2xsTGVmdCcsIHRvKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFNjcm9sbCB2ZXJ0aWNhbGx5XHJcbiAgICogQHBhcmFtIHRvXHJcbiAgICogQHBhcmFtIGR1cmF0aW9uXHJcbiAgICovXHJcbiAgc2Nyb2xsWVRvKHRvOiBudW1iZXIsIGR1cmF0aW9uPzogbnVtYmVyKSB7XHJcbiAgICBpZiAoZHVyYXRpb24pIHtcclxuICAgICAgb2YoZHVyYXRpb24pLnBpcGUoXHJcbiAgICAgICAgdGFrZVdoaWxlKCgpID0+IGR1cmF0aW9uID4gMCksXHJcbiAgICAgICAgZXhwYW5kKChkOiBudW1iZXIpID0+IHtcclxuICAgICAgICAgIGlmIChkID4gMCkge1xyXG4gICAgICAgICAgICBjb25zdCBkaWZmZXJlbmNlID0gdG8gLSB0aGlzLnZpZXcuc2Nyb2xsVG9wO1xyXG4gICAgICAgICAgICBjb25zdCBwZXJUaWNrID0gZGlmZmVyZW5jZSAvIGQgKiAxMDtcclxuICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5zZXRQcm9wZXJ0eSh0aGlzLnZpZXcsICdzY3JvbGxUb3AnLCB0aGlzLnZpZXcuc2Nyb2xsVG9wICsgcGVyVGljayk7XHJcbiAgICAgICAgICAgIHJldHVybiBvZihkIC0gMTApLnBpcGUoZGVsYXkoMTApKTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGR1cmF0aW9uID0gZDtcclxuICAgICAgICAgICAgcmV0dXJuIEVNUFRZO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICAgICkuc3Vic2NyaWJlKCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLnJlbmRlcmVyLnNldFByb3BlcnR5KHRoaXMudmlldywgJ3Njcm9sbFRvcCcsIHRvKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFNjcm9sbCB2aWV3IHRvIHRvcFxyXG4gICAqIEBwYXJhbSBkdXJhdGlvblxyXG4gICAqL1xyXG4gIHNjcm9sbFRvVG9wKGR1cmF0aW9uPzogbnVtYmVyKSB7XHJcbiAgICB0aGlzLnNjcm9sbFlUbygwLCBkdXJhdGlvbik7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBTY3JvbGwgdmlldyB0byBib3R0b21cclxuICAgKiBAcGFyYW0gZHVyYXRpb25cclxuICAgKi9cclxuICBzY3JvbGxUb0JvdHRvbShkdXJhdGlvbj86IG51bWJlcikge1xyXG4gICAgdGhpcy5zY3JvbGxZVG8odGhpcy52aWV3LnNjcm9sbEhlaWdodCwgZHVyYXRpb24pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogU2Nyb2xsIHZpZXcgdG8gbWF4IHJpZ2h0XHJcbiAgICogQHBhcmFtIGR1cmF0aW9uXHJcbiAgICovXHJcbiAgc2Nyb2xsVG9SaWdodChkdXJhdGlvbj86IG51bWJlcikge1xyXG4gICAgdGhpcy5zY3JvbGxYVG8odGhpcy52aWV3LnNjcm9sbFdpZHRoLCBkdXJhdGlvbik7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBTY3JvbGwgdmlldyB0byBtYXggbGVmdFxyXG4gICAqIEBwYXJhbSBkdXJhdGlvblxyXG4gICAqL1xyXG4gIHNjcm9sbFRvTGVmdChkdXJhdGlvbj86IG51bWJlcikge1xyXG4gICAgdGhpcy5zY3JvbGxYVG8oMCwgZHVyYXRpb24pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogVXBkYXRlIHRodW1ibmFpbHNcclxuICAgKi9cclxuICB1cGRhdGUoKSB7XHJcbiAgICB0aGlzLnNldFRodW1iWFBvc2l0aW9uKHRoaXMuX2N1cnJYUG9zLCB0aGlzLmNhbGN1bGF0ZVRodW1iWFNpemUoKSk7XHJcbiAgICB0aGlzLnNldFRodW1iWVBvc2l0aW9uKHRoaXMuX2N1cnJZUG9zLCB0aGlzLmNhbGN1bGF0ZVRodW1iWVNpemUoKSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBTY3JvbGwgV29ya2VyXHJcbiAgICogQHBhcmFtIGUgLSBNb3VzZSBFdmVudFxyXG4gICAqL1xyXG4gIHByaXZhdGUgc2Nyb2xsV29ya2VyKGU6IGFueSkge1xyXG4gICAgdGhpcy5fdGh1bWJTaXplWCA9IHRoaXMudGh1bWJYLmNsaWVudFdpZHRoO1xyXG4gICAgdGhpcy5fdGh1bWJTaXplWSA9IHRoaXMudGh1bWJZLmNsaWVudEhlaWdodDtcclxuXHJcbiAgICB0aGlzLl90cmFja0xlZnRNYXggPSB0aGlzLmJhclguY2xpZW50V2lkdGggLSB0aGlzLl90aHVtYlNpemVYO1xyXG4gICAgdGhpcy5fdHJhY2tUb3BNYXggPSB0aGlzLmJhclkuY2xpZW50SGVpZ2h0IC0gdGhpcy5fdGh1bWJTaXplWTtcclxuXHJcbiAgICBjb25zdCB0aHVtYlhQb3NpdGlvbiA9IHRoaXMudmlldy5zY3JvbGxMZWZ0ICogdGhpcy5fdHJhY2tMZWZ0TWF4IC8gdGhpcy5fc2Nyb2xsTGVmdE1heDtcclxuICAgIGNvbnN0IHRodW1iWVBvc2l0aW9uID0gdGhpcy52aWV3LnNjcm9sbFRvcCAqIHRoaXMuX3RyYWNrVG9wTWF4IC8gdGhpcy5fc2Nyb2xsVG9wTWF4O1xyXG5cclxuICAgIHRoaXMuc2V0VGh1bWJYUG9zaXRpb24odGh1bWJYUG9zaXRpb24sIHRoaXMuY2FsY3VsYXRlVGh1bWJYU2l6ZSgpKTtcclxuICAgIHRoaXMuc2V0VGh1bWJZUG9zaXRpb24odGh1bWJZUG9zaXRpb24sIHRoaXMuY2FsY3VsYXRlVGh1bWJZU2l6ZSgpKTtcclxuXHJcbiAgICAvKiogRW1pdCBzY3JvbGwgc3RhdGUgKi9cclxuICAgIHRoaXMuc2Nyb2xsU3RhdGUuZW1pdChlKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEhvcml6b250YWwgc2Nyb2xsYmFyIGNsaWNrIHdvcmtlclxyXG4gICAqIEBwYXJhbSBlIC0gTW91c2UgRXZlbnRcclxuICAgKi9cclxuICBwcml2YXRlIGJhclhXb3JrZXIoZTogYW55KSB7XHJcbiAgICBpZiAoZS50YXJnZXQgPT09IGUuY3VycmVudFRhcmdldCkge1xyXG4gICAgICBjb25zdCBvZmZzZXQgPSBlLm9mZnNldFggLSB0aGlzLl9uYXR1cmFsVGh1bWJTaXplWCAqIC41O1xyXG4gICAgICBjb25zdCB0aHVtYlBvc2l0aW9uUGVyY2VudGFnZSA9IG9mZnNldCAqIDEwMCAvIHRoaXMuYmFyWC5jbGllbnRXaWR0aDtcclxuICAgICAgY29uc3Qgc2Nyb2xsTGVmdCA9IHRodW1iUG9zaXRpb25QZXJjZW50YWdlICogdGhpcy52aWV3LnNjcm9sbFdpZHRoIC8gMTAwO1xyXG4gICAgICB0aGlzLnJlbmRlcmVyLnNldFByb3BlcnR5KHRoaXMudmlldywgJ3Njcm9sbExlZnQnLCBzY3JvbGxMZWZ0KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFZlcnRpY2FsIHNjcm9sbGJhciBjbGljayB3b3JrZXJcclxuICAgKiBAcGFyYW0gZSAtIE1vdXNlIEV2ZW50XHJcbiAgICovXHJcbiAgcHJpdmF0ZSBiYXJZV29ya2VyKGU6IGFueSkge1xyXG4gICAgaWYgKGUudGFyZ2V0ID09PSBlLmN1cnJlbnRUYXJnZXQpIHtcclxuICAgICAgY29uc3Qgb2Zmc2V0ID0gZS5vZmZzZXRZIC0gdGhpcy5fbmF0dXJhbFRodW1iU2l6ZVkgKiAuNTtcclxuICAgICAgY29uc3QgdGh1bWJQb3NpdGlvblBlcmNlbnRhZ2UgPSBvZmZzZXQgKiAxMDAgLyB0aGlzLmJhclkuY2xpZW50SGVpZ2h0O1xyXG4gICAgICBjb25zdCBzY3JvbGxUb3AgPSB0aHVtYlBvc2l0aW9uUGVyY2VudGFnZSAqIHRoaXMudmlldy5zY3JvbGxIZWlnaHQgLyAxMDA7XHJcbiAgICAgIHRoaXMucmVuZGVyZXIuc2V0UHJvcGVydHkodGhpcy52aWV3LCAnc2Nyb2xsVG9wJywgc2Nyb2xsVG9wKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFN0YXJ0IGhvcml6b250YWwgdGh1bWIgd29ya2VyXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBzdGFydFRodW1iWFdvcmtlcigpOiBTdWJzY3JpcHRpb24ge1xyXG4gICAgY29uc3QgbW91c2Vkb3duJCA9IGZyb21FdmVudCh0aGlzLnRodW1iWCwgJ21vdXNlZG93bicpO1xyXG4gICAgY29uc3QgbW91c2V1cCQgPSBmcm9tRXZlbnQodGhpcy5kb2N1bWVudCwgJ21vdXNldXAnKTtcclxuICAgIGNvbnN0IG1vdXNlbW92ZSQgPSBmcm9tRXZlbnQodGhpcy5kb2N1bWVudCwgJ21vdXNlbW92ZScpO1xyXG4gICAgcmV0dXJuIG1vdXNlZG93biQucGlwZShcclxuICAgICAgdGFwKCgpID0+IHRoaXMuZG9jdW1lbnQub25zZWxlY3RzdGFydCA9ICgpID0+IGZhbHNlKSxcclxuICAgICAgbWFwKChtb3VzZWRvd25FdmVudDogYW55KSA9PiBtb3VzZWRvd25FdmVudC5vZmZzZXRYKSxcclxuICAgICAgbWVyZ2VNYXAoKG1vdXNlZG93bk9mZnNldFg6IG51bWJlcikgPT4gbW91c2Vtb3ZlJC5waXBlKFxyXG4gICAgICAgIHRha2VVbnRpbChtb3VzZXVwJC5waXBlKHRhcCgoKSA9PiB0aGlzLmRvY3VtZW50Lm9uc2VsZWN0c3RhcnQgPSBudWxsKSkpLFxyXG4gICAgICAgIG1hcCgobW91c2Vtb3ZlRXZlbnQ6IGFueSkgPT4gbW91c2Vtb3ZlRXZlbnQuY2xpZW50WCksXHJcbiAgICAgICAgdGFwKChtb3VzZW1vdmVDbGllbnRYOiBudW1iZXIpID0+IHtcclxuICAgICAgICAgIGNvbnN0IG9mZnNldCA9IG1vdXNlbW92ZUNsaWVudFggLSB0aGlzLmJhclguZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkubGVmdDtcclxuICAgICAgICAgIGNvbnN0IHNjcm9sbCA9IHRoaXMuX3Njcm9sbExlZnRNYXggKiAob2Zmc2V0IC0gbW91c2Vkb3duT2Zmc2V0WCkgLyB0aGlzLl90cmFja0xlZnRNYXg7XHJcbiAgICAgICAgICB0aGlzLnJlbmRlcmVyLnNldFByb3BlcnR5KHRoaXMudmlldywgJ3Njcm9sbExlZnQnLCBzY3JvbGwpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICkpXHJcbiAgICApLnN1YnNjcmliZSgpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogU3RhcnQgdmVydGljYWwgdGh1bWIgd29ya2VyXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBzdGFydFRodW1iWVdvcmtlcigpOiBTdWJzY3JpcHRpb24ge1xyXG4gICAgY29uc3QgbW91c2Vkb3duJCA9IGZyb21FdmVudCh0aGlzLnRodW1iWSwgJ21vdXNlZG93bicpO1xyXG4gICAgY29uc3QgbW91c2V1cCQgPSBmcm9tRXZlbnQodGhpcy5kb2N1bWVudCwgJ21vdXNldXAnKTtcclxuICAgIGNvbnN0IG1vdXNlbW92ZSQgPSBmcm9tRXZlbnQodGhpcy5kb2N1bWVudCwgJ21vdXNlbW92ZScpO1xyXG4gICAgcmV0dXJuIG1vdXNlZG93biQucGlwZShcclxuICAgICAgdGFwKCgpID0+IHRoaXMuZG9jdW1lbnQub25zZWxlY3RzdGFydCA9ICgpID0+IGZhbHNlKSxcclxuICAgICAgbWFwKChtb3VzZWRvd25FdmVudDogYW55KSA9PiBtb3VzZWRvd25FdmVudC5vZmZzZXRZKSxcclxuICAgICAgbWVyZ2VNYXAoKG1vdXNlZG93bk9mZnNldFk6IG51bWJlcikgPT4gbW91c2Vtb3ZlJC5waXBlKFxyXG4gICAgICAgIHRha2VVbnRpbChtb3VzZXVwJC5waXBlKHRhcCgoKSA9PiB0aGlzLmRvY3VtZW50Lm9uc2VsZWN0c3RhcnQgPSBudWxsKSkpLFxyXG4gICAgICAgIG1hcCgobW91c2Vtb3ZlRXZlbnQ6IGFueSkgPT4gbW91c2Vtb3ZlRXZlbnQuY2xpZW50WSksXHJcbiAgICAgICAgdGFwKChtb3VzZW1vdmVDbGllbnRZOiBudW1iZXIpID0+IHtcclxuICAgICAgICAgIGNvbnN0IG9mZnNldCA9IG1vdXNlbW92ZUNsaWVudFkgLSB0aGlzLmJhclkuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkudG9wO1xyXG4gICAgICAgICAgY29uc3Qgc2Nyb2xsID0gdGhpcy5fc2Nyb2xsVG9wTWF4ICogKG9mZnNldCAtIG1vdXNlZG93bk9mZnNldFkpIC8gdGhpcy5fdHJhY2tUb3BNYXg7XHJcbiAgICAgICAgICB0aGlzLnJlbmRlcmVyLnNldFByb3BlcnR5KHRoaXMudmlldywgJ3Njcm9sbFRvcCcsIHNjcm9sbCk7XHJcbiAgICAgICAgfSlcclxuICAgICAgKSlcclxuICAgICkuc3Vic2NyaWJlKCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBDYWxjdWxhdGUgVGh1bWIgWCBTaXplXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBjYWxjdWxhdGVUaHVtYlhTaXplKCk6IG51bWJlciB7XHJcbiAgICB0aGlzLl9uYXR1cmFsVGh1bWJTaXplWCA9IHRoaXMuYmFyWC5jbGllbnRXaWR0aCAvIHRoaXMudmlldy5zY3JvbGxXaWR0aCAqIHRoaXMuYmFyWC5jbGllbnRXaWR0aDtcclxuICAgIHRoaXMuX3Njcm9sbExlZnRNYXggPSB0aGlzLnZpZXcuc2Nyb2xsV2lkdGggLSB0aGlzLnZpZXcuY2xpZW50V2lkdGg7XHJcbiAgICByZXR1cm4gdGhpcy5zY3JvbGxCb3VuZGFyaWVzKHRoaXMuX25hdHVyYWxUaHVtYlNpemVYLCB0aGlzLl9zY3JvbGxMZWZ0TWF4KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENhbGN1bGF0ZSBUaHVtYiBZIFNpemVcclxuICAgKi9cclxuICBwcml2YXRlIGNhbGN1bGF0ZVRodW1iWVNpemUoKTogbnVtYmVyIHtcclxuICAgIHRoaXMuX25hdHVyYWxUaHVtYlNpemVZID0gdGhpcy5iYXJZLmNsaWVudEhlaWdodCAvIHRoaXMudmlldy5zY3JvbGxIZWlnaHQgKiB0aGlzLmJhclkuY2xpZW50SGVpZ2h0O1xyXG4gICAgdGhpcy5fc2Nyb2xsVG9wTWF4ID0gdGhpcy52aWV3LnNjcm9sbEhlaWdodCAtIHRoaXMudmlldy5jbGllbnRIZWlnaHQ7XHJcbiAgICByZXR1cm4gdGhpcy5zY3JvbGxCb3VuZGFyaWVzKHRoaXMuX25hdHVyYWxUaHVtYlNpemVZLCB0aGlzLl9zY3JvbGxUb3BNYXgpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IHNjcm9sbGJhciB0aHVtYiBzaXplXHJcbiAgICogQHBhcmFtIG5hdHVyYWxUaHVtYlNpemVcclxuICAgKiBAcGFyYW0gc2Nyb2xsTWF4XHJcbiAgICovXHJcbiAgcHJpdmF0ZSBzY3JvbGxCb3VuZGFyaWVzKG5hdHVyYWxUaHVtYlNpemU6IG51bWJlciwgc2Nyb2xsTWF4OiBudW1iZXIpOiBudW1iZXIge1xyXG4gICAgcmV0dXJuIChuYXR1cmFsVGh1bWJTaXplIDwgdGhpcy5fbWluVGh1bWJTaXplKSA/IHRoaXMuX21pblRodW1iU2l6ZSA6IHNjcm9sbE1heCA/IG5hdHVyYWxUaHVtYlNpemUgOiAwO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogU2V0IGhvcml6b250YWwgc2Nyb2xsYmFyIHRodW1iIHN0eWxlXHJcbiAgICogQHBhcmFtIHhcclxuICAgKiBAcGFyYW0gd2lkdGhcclxuICAgKi9cclxuICBwcml2YXRlIHNldFRodW1iWFBvc2l0aW9uKHg6IG51bWJlciwgd2lkdGg6IG51bWJlcikge1xyXG4gICAgY29uc3QgdHJhbnNmb3JtID0gYHRyYW5zbGF0ZTNkKCR7eH1weCwgMCwgMClgO1xyXG4gICAgdGhpcy5yZW5kZXJlci5zZXRTdHlsZSh0aGlzLnRodW1iWCwgJ3RyYW5zZm9ybScsIHRyYW5zZm9ybSk7XHJcbiAgICB0aGlzLnJlbmRlcmVyLnNldFN0eWxlKHRoaXMudGh1bWJYLCAnd2lkdGgnLCB3aWR0aCArICdweCcpO1xyXG4gICAgdGhpcy5fY3VyclhQb3MgPSB4O1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogU2V0IHZlcnRpY2FsIHNjcm9sbGJhciB0aHVtYiBzdHlsZVxyXG4gICAqIEBwYXJhbSB5XHJcbiAgICogQHBhcmFtIGhlaWdodFxyXG4gICAqL1xyXG4gIHByaXZhdGUgc2V0VGh1bWJZUG9zaXRpb24oeTogbnVtYmVyLCBoZWlnaHQ6IG51bWJlcikge1xyXG4gICAgY29uc3QgdHJhbnNmb3JtID0gYHRyYW5zbGF0ZTNkKDAsICR7eX1weCwgMClgO1xyXG4gICAgdGhpcy5yZW5kZXJlci5zZXRTdHlsZSh0aGlzLnRodW1iWSwgJ3RyYW5zZm9ybScsIHRyYW5zZm9ybSk7XHJcbiAgICB0aGlzLnJlbmRlcmVyLnNldFN0eWxlKHRoaXMudGh1bWJZLCAnaGVpZ2h0JywgaGVpZ2h0ICsgJ3B4Jyk7XHJcbiAgICB0aGlzLl9jdXJyWVBvcyA9IHk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBIaWRlIG5hdGl2ZSBzY3JvbGxiYXJzXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBoaWRlTmF0aXZlU2Nyb2xsYmFycygpIHtcclxuICAgIGNvbnN0IHNpemUgPSBgY2FsYygxMDAlICsgJHt0aGlzLmdldE5hdGl2ZVNjcm9sbGJhcldpZHRoKCl9cHgpYDtcclxuICAgIHRoaXMucmVuZGVyZXIuc2V0U3R5bGUodGhpcy52aWV3LCAnd2lkdGgnLCBzaXplKTtcclxuICAgIHRoaXMucmVuZGVyZXIuc2V0U3R5bGUodGhpcy52aWV3LCAnaGVpZ2h0Jywgc2l6ZSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZXQgdGhlIG5hdGl2ZSBzY3JvbGxiYXIgd2lkdGhcclxuICAgKi9cclxuICBwcml2YXRlIGdldE5hdGl2ZVNjcm9sbGJhcldpZHRoKCk6IG51bWJlciB7XHJcbiAgICBjb25zdCBlbGVtZW50ID0gdGhpcy5kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgIGVsZW1lbnQuc3R5bGUucG9zaXRpb24gPSAnYWJzb2x1dGUnO1xyXG4gICAgZWxlbWVudC5zdHlsZS50b3AgPSAnLTk5OTlweCc7XHJcbiAgICBlbGVtZW50LnN0eWxlLndpZHRoID0gJzEwMHB4JztcclxuICAgIGVsZW1lbnQuc3R5bGUuaGVpZ2h0ID0gJzEwMHB4JztcclxuICAgIGVsZW1lbnQuc3R5bGUub3ZlcmZsb3cgPSAnc2Nyb2xsJztcclxuICAgIGVsZW1lbnQuc3R5bGUubXNPdmVyZmxvd1N0eWxlID0gJ3Njcm9sbGJhcic7XHJcbiAgICB0aGlzLmRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoZWxlbWVudCk7XHJcbiAgICBjb25zdCBzdyA9IGVsZW1lbnQub2Zmc2V0V2lkdGggLSBlbGVtZW50LmNsaWVudFdpZHRoO1xyXG4gICAgdGhpcy5kb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKGVsZW1lbnQpO1xyXG4gICAgcmV0dXJuIHN3O1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgeyBDb21tb25Nb2R1bGUgfSBmcm9tICdAYW5ndWxhci9jb21tb24nO1xyXG5pbXBvcnQgeyBOZ01vZHVsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBPYnNlcnZlcnNNb2R1bGUgfSBmcm9tICdAYW5ndWxhci9jZGsvb2JzZXJ2ZXJzJztcclxuaW1wb3J0IHsgU2Nyb2xsYmFyQ29tcG9uZW50IH0gZnJvbSAnLi9zY3JvbGxiYXIuY29tcG9uZW50JztcclxuXHJcbkBOZ01vZHVsZSh7XHJcbiAgaW1wb3J0czogW1xyXG4gICAgQ29tbW9uTW9kdWxlLFxyXG4gICAgT2JzZXJ2ZXJzTW9kdWxlXHJcbiAgXSxcclxuICBkZWNsYXJhdGlvbnM6IFtTY3JvbGxiYXJDb21wb25lbnRdLFxyXG4gIGV4cG9ydHM6IFtTY3JvbGxiYXJDb21wb25lbnRdXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBTY3JvbGxiYXJNb2R1bGUge1xyXG59XHJcbiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQUE7Ozs7OztJQWtGRSxZQUFvQixJQUFZLEVBQVUsUUFBbUIsRUFBNEI7UUFBckUsU0FBSSxHQUFKLElBQUksQ0FBUTtRQUFVLGFBQVEsR0FBUixRQUFRLENBQVc7UUFBNEIsYUFBUSxHQUFSLFFBQVE7MkJBdEMzRSxDQUFDOzJCQUNELENBQUM7NEJBQ0EsQ0FBQzs2QkFDQSxDQUFDOzhCQUNBLENBQUM7NkJBQ0YsQ0FBQztrQ0FDSSxDQUFDO2tDQUNELENBQUM7eUJBQ1YsQ0FBQzt5QkFDRCxDQUFDOzZCQUNHLEVBQUU7MEJBbUJKLElBQUk7d0JBQ04sS0FBSztzQkFDUCxLQUFLO3NCQUNMLElBQUk7MkJBSUUsSUFBSSxZQUFZLEVBQU87S0FHOUM7Ozs7SUFFRCxlQUFlO1FBRWIsSUFBSSxDQUFDLElBQUksQ0FBQyxpQkFBaUIsQ0FBQztZQUMxQixJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQyxPQUFPLENBQUMsYUFBYSxDQUFDO1lBQ3ZDLElBQUksQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQyxhQUFhLENBQUM7WUFDdkMsSUFBSSxDQUFDLE1BQU0sR0FBRyxJQUFJLENBQUMsU0FBUyxD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